- en: Replace Temp with Query
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://refactoringguru.cn/replace-temp-with-query](https://refactoringguru.cn/replace-temp-with-query)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Problem
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You place the result of an expression in a local variable for later use in your
    code.
  prefs: []
  type: TYPE_NORMAL
- en: Solution
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Move the entire expression to a separate method and return the result from it.
    Query the method instead of using a variable. Incorporate the new method in other
    methods, if necessary.
  prefs: []
  type: TYPE_NORMAL
- en: Before
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: After
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Before
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: After
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Before
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: After
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Before
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: After
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Before
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: After
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Why Refactor
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This refactoring can lay the groundwork for applying [Extract Method](/extract-method)
    for a portion of a very long method.
  prefs: []
  type: TYPE_NORMAL
- en: The same expression may sometimes be found in other methods as well, which is
    one reason to consider creating a common method.
  prefs: []
  type: TYPE_NORMAL
- en: Benefits
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Code readability. It's much easier to understand the purpose of the method `getTax()`
    than the line `orderPrice() * 0.2`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Slimmer code via deduplication, if the line being replaced is used in multiple
    methods.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Good to Know
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Performance
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'This refactoring may prompt the question of whether this approach is liable
    to cause a performance hit. The honest answer is: yes, it is, since the resulting
    code may be burdened by querying a new method. But with today''s fast CPUs and
    excellent compilers, the burden will almost always be minimal. By contrast, readable
    code and the ability to reuse this method in other places in program code—thanks
    to this refactoring approach—are very noticeable benefits.'
  prefs: []
  type: TYPE_NORMAL
- en: Nonetheless, if your temp variable is used to cache the result of a truly time-consuming
    expression, you may want to stop this refactoring after extracting the expression
    to a new method.
  prefs: []
  type: TYPE_NORMAL
- en: How to Refactor
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Make sure that a value is assigned to the variable once and only once within
    the method. If not, use [Split Temporary Variable](/split-temporary-variable)
    to ensure that the variable will be used only to store the result of your expression.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use [Extract Method](/extract-method) to place the expression of interest in
    a new method. Make sure that this method only returns a value and doesn't change
    the state of the object. If the method affects the visible state of the object,
    use [Separate Query from Modifier](/separate-query-from-modifier).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Replace the variable with a query to your new method.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[</images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56>'
  prefs: []
  type: TYPE_NORMAL
- en: </images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4>
  prefs: []
  type: TYPE_NORMAL
- en: Your browser does not support HTML video.](/refactoring/course)
  prefs: []
  type: TYPE_NORMAL
- en: Tired of reading?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: No wonder, it takes 7 hours to read all of the text we have here.
  prefs: []
  type: TYPE_NORMAL
- en: Try our interactive course on refactoring. It offers a less tedious approach
    to learning new stuff.
  prefs: []
  type: TYPE_NORMAL
- en: '[*Let''s see…*](/refactoring/course)'
  prefs: []
  type: TYPE_NORMAL
