<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>How to refactor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>How to refactor</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/refactoring/how-to">https://refactoringguru.cn/refactoring/how-to</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

                
    <p>Refactoring should be done as a series of small changes, each of which makes the existing code slightly better while still leaving the program in working order.</p>
<h2><i class="fa fa-clipboard-list-check" aria-hidden="true"/>  Checklist of refactoring done <em>right way</em></h2>
<h4><i class="fa fa-check-square" aria-hidden="true"/> The code should become cleaner.</h4>
<p>If the code remains just as unclean after refactoring... well, I'm sorry, but you've just wasted an hour of your life. Try to figure out why this happened.</p>
<p>It frequently happens when you move away from refactoring with small changes and mix a whole bunch of refactorings into one big change. So it's very easy to lose your mind, especially if you have a time limit.</p>
<p>But it can also happen when working with extremely sloppy code. Whatever you improve, the code as a whole remains a disaster.</p>
<p>In this case, it's worthwhile to think about completely rewriting parts of the code. But before that, you should have written tests and set aside a good chunk of time. Otherwise, you'll end up with the kinds of results we talked about in the first paragraph.</p>
<h4><i class="fa fa-check-square" aria-hidden="true"/> New functionality shouldn't be created during refactoring.</h4>
<p>Don't mix refactoring and direct development of new features. Try to separate these processes at least within the confines of individual commits.</p>
<h4><i class="fa fa-check-square" aria-hidden="true"/> All existing tests must pass after refactoring.</h4>
<p>There are two cases when tests can break down after refactoring:</p>
<ul>
<li>
<p><strong>You made an error during refactoring.</strong> This one is a no-brainer: go ahead and fix the error.</p>
</li>
<li>
<p><strong>Your tests were too low-level.</strong> For example, you were testing private methods of classes.</p>
<p>In this case, the tests are to blame. You can either refactor the tests themselves or write an entirely new set of higher-level tests. A great way to avoid this kind of a situation is to write <a href="/refactoring/bdd">BDD-style</a> tests.</p>
</li>
</ul>

        
</body>
</html>