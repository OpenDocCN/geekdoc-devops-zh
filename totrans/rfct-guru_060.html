<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Change Value to Reference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Change Value to Reference</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/change-value-to-reference">https://refactoringguru.cn/change-value-to-reference</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    

    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>So you have many identical instances of a single class that you need to replace with a single object.</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Convert the identical objects to a single reference object.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container ">
                <div class="before">
                    <div class="ba">Before</div>
                                            <div class="ba-container"><img src="../Images/babb47ba3a04f231bd232dea19333dfb.png" alt="Change Value to Reference - Before" width="396" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Change Value to Reference - Before.png?id=b2e65e5bb87366e8195bab6933c15250"/></div>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <div class="ba-container"><img src="../Images/4a912d8cc3dfe96d547f269e9dad3bff.png" alt="Change Value to Reference - After" width="396" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Change Value to Reference - After.png?id=20d3bdea32264097859011bacb4ff19f"/></div>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>In many systems, objects can be classified as either values or references.</p>
<ul>
<li>
<p><strong>References</strong>: when one real-world object corresponds to only one object in the program. References are usually user/order/product/etc. objects.</p>
</li>
<li>
<p><strong>Values</strong>: one real-world object corresponds to multiple objects in the program. These objects could be dates, phone numbers, addresses, colors, and the like.</p>
</li>
</ul>
<p>The selection of reference vs. value isn't always clear-cut. Sometimes there's a simple value with a small amount of unchanging data. Then it becomes necessary to add changeable data and pass these changes every time the object is accessed. In this case it becomes necessary to convert it to a reference.</p>
<h3>Benefits</h3>
<ul>
<li>An object contains all the most current information about a particular entity. If the object is changed in one part of the program, these changes are accessible from the other parts of the program that make use of the object.</li>
</ul>
<h3>Drawbacks</h3>
<ul>
<li>References are much harder to implement.</li>
</ul>
<h3>How to Refactor</h3>
<ol>
<li>
<p>Use <a href="/replace-constructor-with-factory-method">Replace Constructor with Factory Method</a> on the class from which the references are to be generated.</p>
</li>
<li>
<p>Determine which object will be responsible for providing access to references. Instead of creating a new object, when you need one you now need to get it from a storage object or static dictionary field.</p>
</li>
<li>
<p>Determine whether references will be created in advance or dynamically as necessary. If objects are created in advance, make sure to load them before use.</p>
</li>
<li>
<p>Change the factory method so that it returns a reference. If objects are created in advance, decide how to handle errors when a non-existent object is requested. You may also need to use <a href="/rename-method">Rename Method</a> to inform that the method returns only existing objects.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>