<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Introduce Local Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Introduce Local Extension</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/introduce-local-extension">https://refactoringguru.cn/introduce-local-extension</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    

    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>A utility class doesn't contain some methods that you need. But you can't add these methods to the class.</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Create a new class containing the methods and make it either the child or wrapper of the utility class.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container ">
                <div class="before">
                    <div class="ba">Before</div>
                                            <div class="ba-container"><img src="../Images/5174e7d68cffb107712c086094635e3f.png" alt="Introduce Local Extension - Before" width="209" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Introduce Local Extension - Before.png?id=3ba103e769691215bed0a50e1de1b80f"/></div>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <div class="ba-container"><img src="../Images/58ac66e2c1e86cdf9d6eb9ff334742ef.png" alt="Introduce Local Extension - After" width="209" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Introduce Local Extension - After.png?id=44bc24e5c4b86e28a9dfc9c67c9e21d1"/></div>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>The class that you're using doesn't have the methods that you need. What's worse, you can't add these methods (because the classes are in a third-party library, for example). There are two ways out:</p>
<ul>
<li>
<p>Create a <strong>subclass</strong> from the relevant class, containing the methods and inheriting everything else from the parent class. This way is easier but is sometimes blocked by the utility class itself (due to <code>final</code>).</p>
</li>
<li>
<p>Create a <strong>wrapper</strong> class that contains all the new methods and elsewhere will delegate to the related object from the utility class. This method is more work since you need not only code to maintain the relationship between the wrapper and utility object, but also a large number of simple delegating methods in order to emulate the public interface of the utility class.</p>
</li>
</ul>
<h3>Benefits</h3>
<ul>
<li>By moving additional methods to a separate extension class (wrapper or subclass), you avoid gumming up client classes with code that doesn't fit. Program components are more coherent and are more reusable.</li>
</ul>
<h3>How to Refactor</h3>
<ol>
<li>
<p>Create a new extension class:</p>
<ul>
<li>
<p>Option A: Make it a child of the utility class.</p>
</li>
<li>
<p>Option B: If you have decided to make a wrapper, create a field in it for storing the utility class object to which delegation will be made. When using this option, you will need to also create methods that repeat the public methods of the utility class and contain simple delegation to the methods of the utility object.</p>
</li>
</ul>
</li>
<li>
<p>Create a constructor that uses the parameters of the constructor of the utility class.</p>
</li>
<li>
<p>Also create an alternative "converting" constructor that takes only the object of the original class in its parameters. This will help to substitute the extension for the objects of the original class.</p>
</li>
<li>
<p>Create new extended methods in the class. Move foreign methods from other classes to this class or else delete the foreign methods if their functionality is already present in the extension.</p>
</li>
<li>
<p>Replace use of the utility class with the new extension class in places where its functionality is needed.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>