<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Replace Subclass with Fields</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Replace Subclass with Fields</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/replace-subclass-with-fields">https://refactoringguru.cn/replace-subclass-with-fields</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    

    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>You have subclasses differing only in their (constant-returning) methods.</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Replace the methods with fields in the parent class and delete the subclasses.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container ">
                <div class="before">
                    <div class="ba">Before</div>
                                            <div class="ba-container"><img src="../Images/930cf3518d32cfbe157da891e57274b8.png" alt="Replace Subclass with Fields - Before" width="415" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Replace Subclass with Fields - Before.png?id=ea6525cc6b55e1a03fdb35def943c675"/></div>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <div class="ba-container"><img src="../Images/05e0e2ebf14b5a93cdc0808d5c022055.png" alt="Replace Subclass with Fields - After" width="152" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Replace Subclass with Fields - After.png?id=bd1b29687aa333b3adbeb2bfb3e78614"/></div>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>Sometimes refactoring is just the ticket for avoiding type code.</p>
<p>In one such case, a hierarchy of subclasses may be different only in the values returned by particular methods. These methods aren't even the result of computation, but are strictly set out in the methods themselves or in the fields returned by the methods. To simplify the class architecture, this hierarchy can be compressed into a single class containing one or several fields with the necessary values, based on the situation.</p>
<p>These changes may become necessary after moving a large amount of functionality from a class hierarchy to another place. The current hierarchy is no longer so valuable and its subclasses are now just dead weight.</p>
<h3>Benefits</h3>
<ul>
<li>Simplifies system architecture. Creating subclasses is overkill if all you want to do is to return different values in different methods.</li>
</ul>
<h3>How to Refactor</h3>
<ol>
<li>
<p>Apply <a href="/replace-constructor-with-factory-method">Replace Constructor with Factory Method</a> to the subclasses.</p>
</li>
<li>
<p>Replace subclass constructor calls with superclass factory method calls.</p>
</li>
<li>
<p>In the superclass, declare fields for storing the values of each of the subclass methods that return constant values.</p>
</li>
<li>
<p>Create a protected superclass constructor for initializing the new fields.</p>
</li>
<li>
<p>Create or modify the existing subclass constructors so that they call the new constructor of the parent class and pass the relevant values to it.</p>
</li>
<li>
<p>Implement each constant method in the parent class so that it returns the value of the corresponding field. Then remove the method from the subclass.</p>
</li>
<li>
<p>If the subclass constructor has additional functionality, use <a href="/inline-method">Inline Method</a> to incorporate the constructor into the superclass factory method.</p>
</li>
<li>
<p>Delete the subclass.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>