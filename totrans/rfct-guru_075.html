<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Consolidate Conditional Expression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Consolidate Conditional Expression</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/consolidate-conditional-expression">https://refactoringguru.cn/consolidate-conditional-expression</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    

    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>You have multiple conditionals that lead to the same result or action.</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Consolidate all these conditionals in a single expression.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container java" data-lang="java">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="java">double disabilityAmount() {
  if (seniority &lt; 2) {
    return 0;
  }
  if (monthsDisabled &gt; 12) {
    return 0;
  }
  if (isPartTime) {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="java">double disabilityAmount() {
  if (isNotEligibleForDisability()) {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container csharp" data-lang="csharp">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="csharp">double DisabilityAmount() 
{
  if (seniority &lt; 2) 
  {
    return 0;
  }
  if (monthsDisabled &gt; 12) 
  {
    return 0;
  }
  if (isPartTime) 
  {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="csharp">double DisabilityAmount()
{
  if (IsNotEligibleForDisability())
  {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container php" data-lang="php">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="php">function disabilityAmount() {
  if ($this-&gt;seniority &lt; 2) {
    return 0;
  }
  if ($this-&gt;monthsDisabled &gt; 12) {
    return 0;
  }
  if ($this-&gt;isPartTime) {
    return 0;
  }
  // compute the disability amount
  ...</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="php">function disabilityAmount() {
  if ($this-&gt;isNotEligibleForDisability()) {
    return 0;
  }
  // compute the disability amount
  ...</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container python" data-lang="python">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="python">def disabilityAmount():
    if seniority &lt; 2:
        return 0
    if monthsDisabled &gt; 12:
        return 0
    if isPartTime:
        return 0
    # Compute the disability amount.
    # ...</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="python">def disabilityAmount():
    if isNotEligibleForDisability():
        return 0
    # Compute the disability amount.
    # ...</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container typescript" data-lang="typescript">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="typescript">disabilityAmount(): number {
  if (seniority &lt; 2) {
    return 0;
  }
  if (monthsDisabled &gt; 12) {
    return 0;
  }
  if (isPartTime) {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="typescript">disabilityAmount(): number {
  if (isNotEligibleForDisability()) {
    return 0;
  }
  // Compute the disability amount.
  // ...
}</pre>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>Your code contains many alternating operators that perform identical actions. It isn't clear why the operators are split up.</p>
<p>The main purpose of consolidation is to extract the conditional to a separate method for greater clarity.</p>
<h3>Benefits</h3>
<ul>
<li>
<p>Eliminates duplicate control flow code. Combining multiple conditionals that have the same "destination" helps to show that you're doing only one complicated check leading to one action.</p>
</li>
<li>
<p>By consolidating all operators, you can now isolate this complex expression in a new method with a name that explains the conditional's purpose.</p>
</li>
</ul>
<h3>How to Refactor</h3>
<p>Before refactoring, make sure that the conditionals don't have any "side effects" or otherwise modify something, instead of simply returning values. Side effects may be hiding in the code executed inside the operator itself, such as when something is added to a variable based on the results of a conditional.</p>
<ol>
<li>
<p>Consolidate the conditionals in a single expression by using <code>and</code> and <code>or</code>. As a general rule when consolidating:</p>
<ul>
<li>
<p>Nested conditionals are joined using <code>and</code>.</p>
</li>
<li>
<p>Consecutive conditionals are joined with <code>or</code>.</p>
</li>
</ul>
</li>
<li>
<p>Perform <a href="/extract-method">Extract Method</a> on the operator conditions and give the method a name that reflects the expression's purpose.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>