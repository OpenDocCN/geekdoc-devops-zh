<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Replace Inheritance with Delegation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Replace Inheritance with Delegation</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/replace-inheritance-with-delegation">https://refactoringguru.cn/replace-inheritance-with-delegation</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    

    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>You have a subclass that uses only a portion of the methods of its superclass (or it's not possible to inherit superclass data).</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Create a field and put a superclass object in it, delegate methods to the superclass object, and get rid of inheritance.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container ">
                <div class="before">
                    <div class="ba">Before</div>
                                            <div class="ba-container"><img src="../Images/887b3d17bf4bf2eb1f074688663e172a.png" alt="Replace Inheritance with Delegation - Before" width="152" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Replace Inheritance with Delegation - Before.png?id=ea9631c50eaae9a19a51f039b44e35bf"/></div>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <div class="ba-container"><img src="../Images/0846621a97f4d93ff403f4d12e083f9c.png" alt="Replace Inheritance with Delegation - After" width="453" data-original-src="https://refactoringguru.cn/images/refactoring/diagrams/Replace Inheritance with Delegation - After.png?id=7c6d23661792658feae42d051b2fd7ea"/></div>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>Replacing inheritance with composition can substantially improve class design if:</p>
<ul>
<li>
<p>Your subclass violates the <em>Liskov substitution principle</em>, i.e., if inheritance was implemented only to combine common code but not because the subclass is an extension of the superclass.</p>
</li>
<li>
<p>The subclass uses only a portion of the methods of the superclass. In this case, it's only a matter of time before someone calls a superclass method that he or she wasn't supposed to call.</p>
</li>
</ul>
<p>In essence, this refactoring technique splits both classes and makes the superclass the helper of the subclass, not its parent. Instead of inheriting all superclass methods, the subclass will have only the necessary methods for delegating to the methods of the superclass object.</p>
<h3>Benefits</h3>
<ul>
<li>
<p>A class doesn't contain any unneeded methods inherited from the superclass.</p>
</li>
<li>
<p>Various objects with various implementations can be put in the delegate field. In effect you get the <a href="/design-patterns/strategy">Strategy</a> design pattern.</p>
</li>
</ul>
<h3>Drawbacks</h3>
<ul>
<li>You have to write many simple delegating methods.</li>
</ul>
<h3>How to Refactor</h3>
<ol>
<li>
<p>Create a field in the subclass for holding the superclass. During the initial stage, place the current object in it.</p>
</li>
<li>
<p>Change the subclass methods so that they use the superclass object instead of <code>this</code>.</p>
</li>
<li>
<p>For methods inherited from the superclass that are called in the client code, create simple delegating methods in the subclass.</p>
</li>
<li>
<p>Remove the inheritance declaration from the subclass.</p>
</li>
<li>
<p>Change the initialization code of the field in which the former superclass is stored by creating a new object.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>