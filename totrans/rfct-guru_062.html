<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Replace Array with Object</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Replace Array with Object</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/replace-array-with-object">https://refactoringguru.cn/replace-array-with-object</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

    
    <blockquote>
<p>This refactoring technique is a special case of <a href="/replace-data-value-with-object">Replace Data Value with Object</a>.</p>
</blockquote>


    <div class="before-after-container">
        <div class="before">
            <h3>Problem</h3>
            <p>You have an array that contains various types of data.</p>

        </div>
        <div class="after">
            <h3>Solution</h3>
            <p>Replace the array with an object that will have separate fields for each element.</p>

        </div>
    </div>

        <div class="examples">
                    <div class="before-after before-after-container java" data-lang="java">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="java">String[] row = new String[2];
row[0] = "Liverpool";
row[1] = "15";</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="java">Performance row = new Performance();
row.setName("Liverpool");
row.setWins("15");</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container csharp" data-lang="csharp">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="csharp">string[] row = new string[2];
row[0] = "Liverpool";
row[1] = "15";</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="csharp">Performance row = new Performance();
row.SetName("Liverpool");
row.SetWins("15");</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container php" data-lang="php">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="php">$row = [];
$row[0] = "Liverpool";
$row[1] = 15;</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="php">$row = new Performance;
$row-&gt;setName("Liverpool");
$row-&gt;setWins(15);</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container python" data-lang="python">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="python">row = [None * 2]
row[0] = "Liverpool"
row[1] = "15"</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="python">row = Performance()
row.setName("Liverpool")
row.setWins("15")</pre>
                                    </div>
            </div>
                    <div class="before-after before-after-container typescript" data-lang="typescript">
                <div class="before">
                    <div class="ba">Before</div>
                                            <pre class="code" lang="typescript">let row = new Array(2);
row[0] = "Liverpool";
row[1] = "15";</pre>
                                    </div>
                <div class="after">
                    <div class="ba">After</div>
                                            <pre class="code" lang="typescript">let row = new Performance();
row.setName("Liverpool");
row.setWins("15");</pre>
                                    </div>
            </div>
            </div>
    
    <h3>Why Refactor</h3>
<p>Arrays are an excellent tool for storing data and collections of a single type. But if you use an array like post office boxes, storing the username in box 1 and the user's address in box 14, you will someday be very unhappy that you did. This approach leads to catastrophic failures when somebody puts something in the wrong "box" and also requires your time for figuring out which data is stored where.</p>
<h3>Benefits</h3>
<ul>
<li>
<p>In the resulting class, you can place all associated behaviors that had been previously stored in the main class or elsewhere.</p>
</li>
<li>
<p>The fields of a class are much easier to document than the elements of an array.</p>
</li>
</ul>
<h3>How to Refactor</h3>
<ol>
<li>
<p>Create the new class that will contain the data from the array. Place the array itself in the class as a public field.</p>
</li>
<li>
<p>Create a field for storing the object of this class in the original class. Don't forget to also create the object itself in the place where you initiated the data array.</p>
</li>
<li>
<p>In the new class, create access methods one by one for each of the array elements. Give them self-explanatory names that indicate what they do. At the same time, replace each use of an array element in the main code with the corresponding access method.</p>
</li>
<li>
<p>When access methods have been created for all elements, make the array private.</p>
</li>
<li>
<p>For each element of the array, create a private field in the class and then change the access methods so that they use this field instead of the array.</p>
</li>
<li>
<p>When all data has been moved, delete the array.</p>
</li>
</ol>


    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>


        
</body>
</html>