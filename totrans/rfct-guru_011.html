<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Primitive Obsession</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Primitive Obsession</h1>
<blockquote>原文：<a href="https://refactoringguru.cn/smells/primitive-obsession">https://refactoringguru.cn/smells/primitive-obsession</a></blockquote>
    
    

    <script type="text/javascript">
        // Shorten examples titles for users.
        var h1 = document.getElementsByTagName("H1")[0];
        if (h1.offsetHeight &amp;gt; 160) {
            h1.className += ' smaller';
        }

        // Small beautification for pattern examples.
        var title = h1.innerHTML;
        title = title.replace(/^(Java|C\+\+|C#|PHP|Python|Ruby|Delphi): (.*)$/, '&amp;lt;strong&amp;gt;$1:&amp;lt;/strong&amp;gt; $2');
        h1.innerHTML = title;
    </script>

                
    <h3>Signs and Symptoms</h3>
<ul>
<li>
<p>Use of primitives instead of small objects for simple tasks (such as currency, ranges, special strings for phone numbers, etc.)</p>
</li>
<li>
<p>Use of constants for coding information (such as a constant <code>USER_ADMIN_ROLE = 1</code> for referring to users with administrator rights.)</p>
</li>
<li>
<p>Use of string constants as field names for use in data arrays.</p>
</li>
</ul>
<figure class="image"><img width="500" height="300" src="../Images/72ef46f8a9ec840be64ef6cba01a57c4.png" srcset="/images/refactoring/content/smells/primitive-obsession-01-2x.png?id=e13be298e4b8d9d4a987972dfc777f4b 2x" data-original-src="https://refactoringguru.cn/images/refactoring/content/smells/primitive-obsession-01.png?id=73e1c5b08ea68a7ad7a66832644e6696"/></figure>
<h3>Reasons for the Problem</h3>
<p>Like most other smells, primitive obsessions are born in moments of weakness. "Just a field for storing some data!" the programmer said. Creating a primitive field is so much easier than making a whole new class, right? And so it was done. Then another field was needed and added in the same way. Lo and behold, the class became huge and unwieldy.</p>
<p>Primitives are often used to "simulate" types. So instead of a separate data type, you have a set of numbers or strings that form the list of allowable values for some entity. Easy-to-understand names are then given to these specific numbers and strings via constants, which is why they're spread wide and far.</p>
<p>Another example of poor primitive use is field simulation. The class contains a large array of diverse data and string constants (which are specified in the class) are used as array indices for getting this data.</p>
<h3>Treatment</h3>
<ul>
<li>
<p>If you have a large variety of primitive fields, it may be possible to logically group some of them into their own class. Even better, move the behavior associated with this data into the class too. For this task, try <a href="/replace-data-value-with-object">Replace Data Value with Object</a>.</p>
 <figure class="image"><img width="500" height="300" src="../Images/3709987ed41b7a12236cde6cbcacdd45.png" srcset="/images/refactoring/content/smells/primitive-obsession-02-2x.png?id=255bbb1e0b340ce3b62a5898e8edc75a 2x" loading="lazy" data-original-src="https://refactoringguru.cn/images/refactoring/content/smells/primitive-obsession-02.png?id=69dfd06eec8d6053e9d88c03ecc78044"/></figure>
</li>
<li>
<p>If the values of primitive fields are used in method parameters, go with <a href="/introduce-parameter-object">Introduce Parameter Object</a> or <a href="/preserve-whole-object">Preserve Whole Object</a>.</p>
</li>
<li>
<p>When complicated data is coded in variables, use <a href="/replace-type-code-with-class">Replace Type Code with Class</a>, <a href="/replace-type-code-with-subclasses">Replace Type Code with Subclasses</a> or <a href="/replace-type-code-with-state-strategy">Replace Type Code with State/Strategy</a>.</p>
</li>
<li>
<p>If there are arrays among the variables, use <a href="/replace-array-with-object">Replace Array with Object</a>.</p>
</li>
</ul>
<figure class="image"><img width="500" height="300" src="../Images/e3c1145a220aa85da05f876b303e9159.png" srcset="/images/refactoring/content/smells/primitive-obsession-03-2x.png?id=bec1080bcf2be14eeda69b0090d5d3fb 2x" loading="lazy" data-original-src="https://refactoringguru.cn/images/refactoring/content/smells/primitive-obsession-03.png?id=ab0a8c7b6188265bb9890424e679af2f"/></figure>
<h3>Payoff</h3>
<ul>
<li>
<p>Code becomes more flexible thanks to use of objects instead of primitives.</p>
</li>
<li>
<p>Better understandability and organization of code. Operations on particular data are in the same place, instead of being scattered. No more guessing about the reason for all these strange constants and why they're in an array.</p>
</li>
<li>
<p>Easier finding of duplicate code.</p>
</li>
</ul>

    <div class="prom banner-content banner banner-striped banner-with-image" data-id="Ref: Part of the ebook" data-creative-id="animated-en" data-position="content_bottom">
        <div class="banner-image">
            <a href="/refactoring/course">
                <video id="banner-zzz" loop="" muted="" playsinline="" width="200" height="200">
                    <source src="/images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56" type="video/mp4">
                    <source src="/images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4" type="image/png">
                    Your browser does not support HTML video.
                </source></source></video>
            </a>
        </div>
        <script>
            if (/CPU (?:iPhone )?OS [1-9]_/.test(navigator.userAgent)) {
                // Don't autoplay on old iOS, since it doesn not support playsinline.
            }
            else {
                document.getElementById('banner-zzz').play();
            }
        </script>

        <div class="banner-text">
            <h3 class="title">Tired of reading?</h3>
            <p class="big">No wonder, it takes <span class="blue">7 hours</span> to read all of the text we have here.</p>
            <p>Try our interactive course on refactoring. It offers a less tedious approach to learning new stuff.</p>
            <a class="btn btn-secondary" href="/refactoring/course"><i class="fa fa-star" aria-hidden="true"/> Let's see…</a>
        </div>
    </div>

    
</body>
</html>