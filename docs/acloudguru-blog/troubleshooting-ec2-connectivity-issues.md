# EC2 连接问题故障排除

> 原文：<https://acloudguru.com/blog/engineering/troubleshooting-ec2-connectivity-issues>

学习 AWS 可能是一个非常漫长和令人畏惧的经历。有几十种主要服务，每一种都有数百种功能需要学习。然而，当试图访问一个已配置的 AWS 资源(如 EC2 实例)时，很少有事情比连接问题更令人沮丧了。  毕竟，您刚刚花了几个小时了解 ami、实例类型、IP 地址、用户数据、存储卷、安全组和密钥对。  现在你只想实际访问这个该死的实例，并从中得到一些乐趣。但是当您试图访问实例时，无论是通过 SSH 还是 HTTP，您都会得到这些可怕的错误之一:“访问被拒绝”，或者“操作超时”，或者其他一些变化。  不管错误——你都不能登录。

AAAAARRRGGGGGG！

好吧，所以你发泄了一点——也许甚至对着你的电脑大喊大叫。  不管你有多沮丧，你还是需要弄清楚哪里出了问题。  考虑到这一点，我将介绍一些导致许多连接性问题的常见(甚至可能很简单)问题。

![Connectivity Path](img/cf5a701800eedfdbb5c470206c7d4467.png)

了解路径:

为了成功地解决 EC2 实例的连接问题，我们首先需要完全理解数据从我们的计算机传输到 EC2 实例时所采用的路径。为了这篇博文的目的，我们必须忽略“开放互联网”这一部分，因为我们无法控制它。  我们将关注的是，一旦数据到达您的 AWS 虚拟私有云(VPC)，因为这部分路径是我们控制的。  在这个练习中，我们将回溯 VPC 的基础设施——也就是说，我们将从 EC2 实例开始，找出从 VPC 到开放互联网的方法。

### EC2 实例:

它有公共 IP 地址吗？

是:继续下一部分。

否:要么创建一个弹性 IP 地址并将其附加到实例*上，要么*终止实例并创建一个新的实例(确保在创建过程中“启用”公共 IP 地址)。再次检查连接。  如果成功了，太好了！  大功告成！  如果没有效果，继续下一节。

### 安全组:

**1)安全组是否有 HTTPS 和/或 SSH 的入站允许规则？**

是:是:转到问题 2。

否:添加 HTTP 和/或 SHH 的允许规则(取决于您的需要)。再次检查连接。  如果成功了，太好了！  大功告成！  如果不奏效，进入下一节。

**2)HTTP 和/或 SSH 是否适用于所有来源的流量(0.0.0.0/0)？**

是:继续下一部分。

否:将每个协议的源编辑为 0.0.0.0/0。再次检查连接。  如果成功了，太好了！  大功告成！  如果不奏效，进入下一节。

注意:对于安全组来说，这不是最佳实践，但是我们在这里只是尝试解决这个问题。

### 子网:

**1)子网路由表是否有到互联网网关的路由？**

是:转到问题 2。

否:编辑路由表以添加到 IGW 目的地= 0.0.0.0/0 和目标=(互联网网关 ID)的路由

注:如果没有 IGW 存在，移动到 IGW 和返回这里的一节。再次检查连接。  如果成功了，太好了！  大功告成！  如果没有效果，进入下一个问题。

保护子网的网络访问控制列表是否有 HTTPS 和/或 SSH 的入站允许规则？

是:转到问题 3。

否:添加 HTTP 和/或 SHH 的允许规则(取决于您的需要)。再次检查连接。  如果成功了，太好了！  大功告成！  如果没有效果，进入下一个问题。

**3)保护子网的网络访问控制列表是否为所有流量设置了出站允许规则？**

是:进入下一部分。

否:编辑出站规则以允许来自所有来源的所有流量(0.0.0.0/0)。再次检查连接。  如果成功了，太好了！  大功告成！  如果不奏效，进入下一节。

### 互联网网关

**1)是否有一个连接到 VPC 的互联网网关，其中已经提供了 EC2 实例？**

是:回到“子网”部分。

号:创造和 IGW 并将其附属于 VPC。回到“子网”部分。

注意:[仅出口互联网网关](https://acloudguru.com/hands-on-labs/enable-ipv6-on-a-vpc-with-a-private-subnet-and-egress-only-internet-gateway)仅支持 IPv6 地址，用于仅出站互联网访问。

好了，你知道了。  希望通过遵循这个指南，您可以很快连接到您的 EC2 实例！

其他相关资源: