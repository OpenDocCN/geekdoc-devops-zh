# 云架构师迁移指南:技巧和工具

> 原文：<https://acloudguru.com/blog/engineering/the-cloud-architects-guide-to-cloud-migration>

在开始全职教学之前，我在一家专业服务咨询公司担任云架构师。在那里，我帮助客户构建令人兴奋的新的云原生解决方案，并且更经常地，将现有的工作负载迁移到云。

我学到了什么？你难道不想知道。。。等等！这应该是一个问题:*难道*你不想知道吗？如果是这样，请继续阅读云迁移领域的一些故事。这些经验教训将有望帮助任何向云(无论是 [Azure](https://acloudguru.com/blog/engineering/4-tips-for-migrating-servers-to-azure) 、AWS、GCP——任何云)迁移的人避免我多年来看到的一些[常见的云迁移错误](https://acloudguru.com/blog/business/4-common-mistakes-when-enterprises-go-cloud)。

### 云迁移经验教训

这些客户中的一些拥有传统的数据中心资产，并且不想支付保持硬件运行或至少在保修期内所需的额外资本支出。一些客户已经将多个应用程序部署到了云环境中，但是被鼓励从大提供商 A 迁移到大提供商 b。他们的共同点是使用各种方法和技术构建的异构系统组合，这意味着任何计划的迁移都不能被认为是微不足道的，并且需要一些付费顾问的技能。(谢天谢地，大供应商 B 通常会买单。)

## 云迁移类型

![Types of cloud migration approaches including lift and shift, move and improve and rip and replace. ](img/0600926ef9c9d7af23213115326c1dc9.png)

概括地说，有三种推荐的云迁移方法。

### 1.提升和移动

首先，我们有“提升和转移”。[什么是提升和转移迁移](https://acloudguru.com/blog/business/what-is-lift-and-shift-cloud-migration)您可能会问……使用这种方法，您只需进行最少的必要更改，就可以将工作负载的托管环境转移到新的云提供商。如果您现有的基础架构由一堆虚拟机组成，这是非常简单的。市场上甚至有产品承诺为您“不用手”地完成这种迁移工作，尽管根据我的经验，总会有一些手握着的情况。这种方法的缺点是，在迁移之后，您无法获得使用云技术的任何好处。你可能只是转向一种不同的账单。

### 2.淘汰并替换

另一个极端是“淘汰和替换”,您可以从头开始重建工作负载，使其成为“云原生的”。如果您能够在时间和技能发展方面进行投资，您将获得云的可扩展性和弹性为您提供的最大好处，并且您将有机会摆脱所有现有的技术债务。

### 3.移动和改进

介于两者之间的是“移动和改进”技术，在这种技术中，您可以对应用程序进行一些更改——例如，引入缩放或自动化——而无需全盘放弃。乍一看，这种令人愉快的方式似乎是最好的选择，但是如果做错了，你可能最终会保留所有的技术债务，并且最终得不到云原生的好处。

## 当简单的迁移顺利进行时

在某些情况下，升降并不是一件坏事。也许大提供商 B 已经承诺给你比大提供商 A 更少的账单，也许你有一个小的、非关键任务的工作负载。

我协助了一次这样的 35 台 Windows 服务器的迁移，使用了前面提到的由提供商推荐的“自动”迁移工具。这些服务器已经在大型提供商 A 中运行了几年，没有使用任何其他特定于云的功能，因此迁移应该相对简单。我们已经做好了事情不完全按计划进行的准备——毕竟，这是 Windows——果然，我们很快就在我们正在迁移的不同版本的 Windows 中发现了不同级别的提供商支持。

此外，我们发现一个非常热心的系统管理员已经离开了客户公司，他决定手动覆盖每台服务器上的所有默认网络配置，这完全破坏了自动迁移。然而，这些问题并不是不可克服的，在几个小时内，我们已经将该资产转移到一个新的、更便宜的、内置弹性稍强的云账单。

## 当复杂的迁移出乎意料地顺利时

一个特别的提升和转变让我吃惊，因为我们高估了它的复杂性。我们的任务是迁移大约 40 个不同的工作负载，这些工作负载已经部署到运行在数据中心的几个物理 Kubernetes 集群上。

作为一名年轻的工程师，我在处理臭名昭著的 container orchestrator 时有一点担心，但我很快发现，它所有假定的 YAML 复杂性只是让它更易于移植——这是它最初的设计目标。我们不得不为新的云提供商的负载平衡器手动重新配置入口，但大多数工作负载都无缝迁移到了新的托管 Kubernetes 服务。我们甚至有剩余的咨询时间，我们用来添加 CI/CD 系统，只是为了好玩！

### “我们一直是这样做的”

“移动和改进”迁移并不总是有我们希望的结果。

工具、流程和技术在不断发展，但是团队和组织有时并没有随之发展。作为一家咨询公司，我们有一种在迁移期间“改进”某些类型的应用程序的首选方法，即应用配置管理，并尝试将它们重塑为可水平扩展的服务。

但是在应用程序复杂性的某一点上，我们选择的配置管理工具就是不能胜任工作，不管我们投入多少时间。我们致力于这种方法，这是一项长期艰巨的任务。回想起来，我们应该放下一点自尊，改变策略。

### 这不是您正在寻找的数据库服务

事实证明，假设是任何云迁移计划中的定时炸弹。

在相同的迁移过程中，我们只需将 MySQL 数据库从一个云提供商迁移到另一个云提供商。MySQL 是一个成熟、可信的数据库，具有坚如磐石的导入和导出能力，但我们被这个特定客户数据库的庞大规模所阻碍。尽管我们尝试了各种方法，但它继续以超过我们新提供商的任何可靠复制的速度增长。我们甚至认为，我们正受到原始宿主的限制，这是对迁移的第一个阻碍。

这一经历让我们震惊，因为在我们的共同努力下，我们已经有了如此多成功的 MySQL 迁移。但是，我们很快发现，问题的一部分是我们不仅仅是在迁移一个数据库，我们是在迁移技术债务的一个组成部分。客户使用 MySQL 存储时间序列数据，这对于关系数据库来说没有太大意义。它已经长成了一个臃肿的庞然大物，为了移动它，几乎需要完全解构。我们不能再假设我们的客户一开始就在“正确地”做事。

### 迁移智慧的临别赠言

我从这些经历中了解到，在大多数情况下，**任何试图通过规避完整的云原生迁移来节省时间、培训或投资的做法，都只是在为自己购买更多的未来技术债务。**

当然，每个组织和工作负载都是不同的，但是如果迁移到云的目的是[利用云的独特功能](https://acloudguru.com/blog/engineering/the-basic-advantages-of-public-cloud)——可伸缩性、弹性、敏捷性、复原力——您将会发现自己很失望，除非您完全接受云原生设计原则并进行一些急需的重构。

你不需要在第一天就“推倒重来”,随着时间的推移，有一些渐进的方法可以帮助你打破你的巨石。变革通常需要在团队中发生，而不仅仅是在技术领域。通过仔细的规划，您可以重新训练您的人员，重构您的代码，并将二者迁移到云成熟的地方。

想要更多云迁移的好处？看看这些:

* * *

### 成为现实世界的专业云架构师需要什么？

我们的[Google Certified Professional Cloud Architect](https://acloudguru.com/course/google-certified-professional-cloud-architect)课程旨在高效教授专业云架构师认证所需的技能，即使用 Google Cloud 技术设计、开发和管理动态解决方案，以推动业务目标。看看您是否具备通过当今最具挑战性和最受欢迎的云计算认证的条件。

* * *