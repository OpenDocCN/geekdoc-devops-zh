# 我的 5 大 Azure 网络技巧

> 原文：<https://acloudguru.com/blog/engineering/my-top-5-azure-networking-tips>

在这篇文章中，我想分享我在设计和部署 Azure 网络服务的过程中所学到的五大 Azure 网络技巧。我保证你不需要铲子。但稍后会详细介绍。。。

Azure 有一系列可用的网络服务，它们在不断发展和改进。当谈到在 Azure 上设计和部署网络时，有一些事情你应该永远记住。

部署到 Azure 很容易。事实上，你只需点击几下鼠标就可以部署一个 Azure 虚拟网络。但是，如果您没有花时间以一种易于维护、增长和发展的方式来设计和部署您的网络，那么改变该网络、向其添加服务以及部署到新的区域和订阅可能会非常困难。

我给你举个例子。假设您有一个虚拟网络，其中部署了许多子网和数百台虚拟机。

如果您需要更改虚拟网络的地址空间，会发生什么情况？微软有一些很好的文档告诉你如何做到这一点。

但是！让我们来看看小字。

`To remove an address range, you must first delete any subnets (and any resources in the subnets) that exist in the address range.`

等等，什么？

是啊。那会有很多工作要做。删除/替换数百台虚拟机。

没人有时间做那个！

让我们用我的五大 Azure 网络技巧来看看如何最小化重复工作并提高可用性、安全性和故障排除。

* * *

[![](img/8f64401f872cec64719ee0b2b5fd0187.png)](https://acloudguru.com/blog/news/whats-free-at-acg)

有什么比学习新的技术技能更好的呢？免费做这件事。查看[本月的免费云课程](https://acloudguru.com/blog/news/whats-free-at-acg)。

* * *

## 1.设计您的虚拟网络和子网

让我们先来看看虚拟网络。在设计虚拟网络时，您只需做出几个决定。它们是:哪个地区和哪个地址范围。

哪个地址范围？您将希望选择一个大小“正好合适”的地址范围，不要太大或太小，并且希望确保它不会与任何现有网络重叠。当您确保它没有重叠时，不要忘记检查内部网络、VPN 连接地址范围，甚至其他云。由于公司扩张、收购和合并，我见过一些有趣的网络架构，包括 AWS VPC 和 Azure 虚拟网络之间的 VPN 连接。

现在我们来看看子网。与虚拟网络一样，您会希望将它们的规模调整得恰到好处，这样就不会耗尽您的地址空间。但也许更重要的是，你要确保你把相似的资源组合在一起。您可以在网络接口(NIC)级别控制虚拟机之间的流量，但是在子网级别更广泛地控制流量要容易得多。

另一个重要的考虑是设计如何控制虚拟网络之间的流量。“为什么这很重要？”你可能会问。嗯，虚拟网络是一个安全和通信边界，当您将虚拟网络连接在一起时，这些墙就会倒塌。有人可能会在连接到另一个虚拟网络之前为虚拟网络做出安全决策，一旦连接了虚拟网络，安全控制就不再足够了。

那么如何才能避免这种情况呢？您可以通过一个共享的“集线器”立即传递虚拟网络之间的所有网络流量，从而实现安全性的集中化。这样，当您以后添加更多网络时，安全控制仍会按预期工作。这被称为“中心辐射”模型，微软在这里有更多关于这个概念的介绍。

## 2.高可用性设计

现在让我们来看看高可用性，这是我最喜欢的话题之一。像 Azure 这样的公共云提供商的一大优势是他们使高可用性变得容易。我记得在我职业生涯的早期，为了提供高可用性，我不得不在不同城市的数据中心之间挖掘光纤。这么说吧，现在轻松多了。

使高可用性在 Azure 上成为可能的重要特性是可用性区域。当您的员工和客户连接到您部署的 Azure 服务时，这种连接严重依赖于提供这种连接的网络服务。

当您部署 Azure 资源和支持网络服务时，请考虑高可用性要求，并根据需要在多个可用性区域和地区部署您的服务。然后，当您部署 Azure 网络服务时，您可以选择部署这些服务，以便它们是区域冗余的，或者支持多个区域中的资源。

## 3.连接现有网络和设备

当您将资源部署到 Azure 时，通过公共连接(如公共 IP 地址)使这些资源可通过互联网访问真的很容易。

现在，您现有的网络和用户可以通过该公共连接进行连接，但通过专用网络连接您面向内部的资源通常更快、更安全。Azure 提供了许多服务，以通过专用连接或通过虚拟专用网络(VPN)在互联网上建立隧道来实现现有网络和用户之间的连接。

所以我的建议是:如果一个资源是私有的，就保持这种状态——通过私有网络连接启用连接，并阻止公共访问。

* * *

[**获得痛苦的云词典**](https://get.acloudguru.com/cloud-dictionary-of-pain)
说云不一定要努力。我们分析了数以百万计的回复，找出了最容易让人犯错的概念。抓住这个[云指南](https://get.acloudguru.com/cloud-dictionary-of-pain)获取一些最痛苦的云术语的简洁定义。

* * *

## 4.为您的网络安全分层

现在我们来谈谈网络安全。当您保护您的资源免受攻击时，您可以尽一切可能在外围防止攻击，但随后会出现一些东西绕过您设置的所有安全措施。

几年前，我在审查针对我们网络基础设施的年度渗透测试的结果。其中一个关键问题显示了一个漏洞，该漏洞允许远程攻击者访问 root 密码，并获得对我们的外围设备的完全管理权限。

你能做些什么来减缓他们的进度或减少影响？您可以部署多个安全层，就像攻击者访问您的安全数据和应用程序需要跨越的障碍一样。

这就是所谓的“纵深防御”Azure 网络服务和功能提供了在多个层保护基础架构的工具，包括外围、网络之间、子网之间以及虚拟机或服务上。

## 5.收集日志和指标

Azure 不仅记录你的资源的所有配置信息，而且使得从你的资源中收集度量和日志数据并集中存储它们变得非常容易。

从来没有人对我说，“我希望你没有收集所有的度量和日志数据。”我发现更普遍的情况是希望我们花时间收集了数据。你永远不知道什么时候你会需要数据来解决“这正常吗？”或者“是什么导致了这一切？”

我的建议在这里？Azure 让收集日志和度量数据变得非常容易，所以在部署资源时打开它。这很可能是无价之宝。

## 了解有关 Azure 网络的更多信息

简单回顾一下，我的五大 Azure 网络技巧是:

*   设计您的虚拟网络和子网
*   高可用性设计
*   连接现有网络和设备
*   为您的网络安全分层
*   收集日志和指标

我希望你觉得这很有用。如果你有兴趣了解更多关于 Azure 网络服务的知识，请查看我的新课程“Azure 网络简介”。

它涵盖了核心的 Azure 网络服务，并探讨了何时使用它们。我们将探讨虚拟网络、安全性、连接性、高可用性和弹性以及故障排除。您还将亲自动手[创建一个虚拟网络](https://acloudguru.com/hands-on-labs/create-a-virtual-network)和[创建一个虚拟机并使用 Azure Bastion](https://acloudguru.com/hands-on-labs/create-a-virtual-machine-and-connect-to-it-using-azure-bastion) 连接到它。

[立即开始 7 天免费试用](https://acloudguru.com/pricing),试一试吧！或者，如果你已经是 ACG 会员，在这里跳到课程[并开始吧。](https://learn.acloud.guru/course/intro-to-networking-on-azure/overview)

* * *

## Azure 您在云中的成功。

提升你的职业生涯。向云专家了解更多最受欢迎的技术技能。查看[本月的免费课程](https://acloudguru.com/blog/news/whats-free-at-acg)或[获得 7 天免费试用](https://acloudguru.com/pricing)。