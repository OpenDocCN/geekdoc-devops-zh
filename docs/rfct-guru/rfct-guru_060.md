# 将值更改为引用

> 原文：[`refactoringguru.cn/change-value-to-reference`](https://refactoringguru.cn/change-value-to-reference)

### 问题

所以你有很多相同实例的单一类，需要用一个对象来替换。

### 解决方案

将相同的对象转换为一个单一的引用对象。

之前！将值更改为引用 - 之前之后！将值更改为引用 - 之后

### 为什么重构

在许多系统中，对象可以被分类为值或引用。

+   **引用**：当一个现实世界的对象只对应程序中的一个对象时。引用通常是用户/订单/产品等对象。

+   **值**：一个现实世界的对象对应程序中的多个对象。这些对象可以是日期、电话号码、地址、颜色等。

引用与值的选择并不总是明确的。有时有一个简单的值，包含少量不变的数据。然后就需要添加可变数据，并在每次访问对象时传递这些更改。在这种情况下，就需要将其转换为引用。

### 好处

+   一个对象包含有关特定实体的所有最新信息。如果程序中的一个部分更改了该对象，这些更改可以从使用该对象的程序的其他部分访问。

### 缺点

+   引用的实现要复杂得多。

### 如何重构

1.  在生成引用的类上使用用工厂方法替换构造函数。

1.  确定哪个对象将负责提供对引用的访问。你不再需要创建一个新对象，而是需要从存储对象或静态字典字段中获取它。

1.  确定引用是提前创建还是根据需要动态创建。如果对象是提前创建的，请确保在使用之前加载它们。

1.  更改工厂方法，使其返回一个引用。如果对象是提前创建的，请决定在请求不存在的对象时如何处理错误。你可能还需要使用重命名方法来通知该方法仅返回现有对象。

</images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56>

</images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4>

你的浏览器不支持 HTML 视频。

### 厌倦阅读了吗？

难怪，阅读我们这里的所有文本需要 7 小时。

尝试我们的交互式重构课程。它提供了一种更轻松的学习新知识的方法。

*让我们看看…*
