# 将单向关联更改为双向

> 原文：[`refactoringguru.cn/change-unidirectional-association-to-bidirectional`](https://refactoringguru.cn/change-unidirectional-association-to-bidirectional)

### 问题

你有两个类需要使用对方的特性，但它们之间的关联仅是单向的。

### 解决方案

将缺失的关联添加到需要它的类中。

之前！将单向关联更改为双向 - 之前之后！将单向关联更改为双向 - 之后

### 为什么重构

最初这些类有单向关联。但随着时间的推移，客户端代码需要访问关联的两侧。

### 好处

+   如果一个类需要反向关联，你可以简单地计算它。但如果这些计算很复杂，最好保留反向关联。

### 缺点

+   双向关联比单向关联更难实现和维护。

+   双向关联使类相互依赖。使用单向关联时，其中一个可以独立于另一个使用。

### 如何重构

1.  添加一个用于保存反向关联的字段。

1.  决定哪个类将是“主导”。这个类将包含创建或更新关联的方法，随着元素的添加或更改，建立类中的关联，并调用建立关联的工具方法。

1.  为“非主导”类创建一个建立关联的工具方法。该方法应使用参数中给定的内容来完成字段。给该方法一个明显的名称，以便之后不会用于其他目的。

1.  如果控制单向关联的旧方法在“主导”类中，请用来自关联对象的工具方法补充这些方法。

1.  如果控制关联的旧方法在“非主导”类中，请在“主导”类中创建这些方法，调用它们并将执行委托给它们。

</images/refactoring/banners/tired-of-reading-banner-1x.mp4?id=7fa8f9682afda143c2a491c6ab1c1e56>

</images/refactoring/banners/tired-of-reading-banner.png?id=1721d160ff9c84cbf8912f5d282e2bb4>

你的浏览器不支持 HTML 视频。

### 读腻了吗？

不奇怪，阅读我们这里所有文本需要 7 小时。

尝试我们的互动重构课程。它提供了一种更轻松的学习新知识的方法。

*让我们看看…*
