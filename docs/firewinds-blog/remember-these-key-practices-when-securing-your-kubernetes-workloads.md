# 在保护您的 Kubernetes 工作负载时，请记住这些关键实践

> 原文：<https://www.fairwinds.com/blog/remember-these-key-practices-when-securing-your-kubernetes-workloads>

 为了真正理解和评估 Kubernetes 集群中的潜在风险，您需要一套强大的保护敏感工作负载的最佳实践。除了简单地遵循可行的建议之外，企业还必须找到访问控制可变性、安全监控和审计考虑事项等内容的方法。事实是，Kubernetes 的成功之路没有对错之分。没错，无效和潜在危险的路径是存在的，但也有一些好的路径。你决定走的路应该是能够解决你的业务需求和优先级的路。

问自己几个问题:

*   我是否身处金融或医疗保健等安全性不容置疑的行业？

*   我是否有一个繁忙的团队或机器学习工作负载，需要以最高的资源效率运行？

*   我的应用和服务能承受任何停机时间吗？还是 99.99%或更高的可靠性才是最重要的因素？

一旦你有了答案，可能还有更多答案，你就有了决定实施 Kubernetes 的最佳方式所需要的信息，创建一个过程并阐明任务和优先级。因此，您将能够更好地探索可供选择的目录和最佳实践。

## 安全第一

今天，组织仍然面临三大最常见(也是最危险)的威胁:

1.  **拒绝服务(DoS)攻击**意味着停机、延迟和可能过高的计算成本。
2.  **外部威胁**可以利用应用程序代码来访问内部资源。
3.  **内部威胁**意味着组织中的个人可以访问其工作范围之外的资源和数据。

尽管云原生技术和 Kubernetes 的世界仍然相对较新，但基本的核心业务挑战依然如故。组织必须找出如何加快开发速度，同时保持健壮的安全实践。这两个业务目标仍然在容器领域争夺同等的关注。

阅读: [Kubernetes 最佳实践:综合白皮书](https://www.fairwinds.com/kubernetes-best-practices-comprehensive-white-paper)

## 最佳实践

显然，保护集群的最佳方式是将人们(及其危险行为)完全排除在库伯内特集群之外。但是考虑到工程师需要与集群本身进行交互——客户需要与集群运行的应用程序进行交互——优化 Kubernetes 的安全性并不容易。

Kubernetes 不会保护您的应用程序代码。它也不能阻止你的开发人员引入导致安全问题的错误和缺陷。Kubernetes 能做的是限制攻击的爆炸半径。这意味着适当的安全控制可以限制不良行为者一旦进入您的集群后能走多远。如果您有正确的安全策略，这个攻击者将被卡住，无法访问容器、应用程序或更大的集群。但是如果容器以根用户身份运行，可以访问主机的文件系统，或者有其他安全缺陷，那么集群就很好……你知道。这就是为什么一个配置良好的 Kubernetes 部署提供了一个额外的急需的安全层。

让我们来看看目前针对 Kubernetes 用户的最佳安全实践:

### DoS 保护:设置限制！

搞垮一个网站最简单的方法就是用 DoS 攻击让它超载。有时这是有意的，有时不是——很难从内心分辨。Kubernetes 的一个主要优点是，它允许应用程序根据这些流量波动进行伸缩。这意味着一个设计良好的入口策略，一个被配置为设置用户可以消耗多少流量的限制的策略，增加了一个额外的安全层来减轻这些风险。

### 更新和补丁:保持最新并定期测试！

保持你的 Kubernetes 版本最新是至关重要的，因为旧版本可能会变得陈旧并充满安全漏洞。安装在集群中的附加组件可以增强功能，但也会增加攻击面。及时更新错误修复和新版本是关键。每当一个新的版本发布时，都需要在内部集群和临时集群上进行测试。缓慢地推出更新，同时监控可能的问题，并在此过程中进行修正。并且不要忘记为你所有的应用程序保持底层 Docker 镜像的最新。基本映像也会过时，需要定期更新。

### RBAC:设置好！

提供管理权限是一件大事，因为它允许个人或应用程序做基本上任何事情，包括删除整个 Kubernetes 部署。不需要控制集群的应用程序不需要管理员权限。Kubernetes 提供 RBAC 来管理对不同集群资源的访问。通过仔细管理您的权限并依靠最小特权原则来降低潜在的风险。

### 网络策略:编写和管理有效的策略！

网络策略不像 RBAC 那样管理对集群资源的访问，而是关注集群内部的通信。虽然给定的工作负载可能需要与一个数据库和一些微服务对话，但工作负载本身不需要访问集群中的所有其他应用程序。确保编写严格的网络策略，将通信限制在群集的不必要部分，并管理群集的入口和出口。有了这些规则，潜在风险就大大降低了。

### 工作负载身份:用一把钥匙管理访问！

您可以通过工作负载识别将 RBAC 与云提供商的认证机制联系起来。Kubernetes 中内置的身份验证机制，用于管理对集群外资源(如数据库)的访问，符合要求。工作负载身份是安全性的关键，因为它使用短期凭证在幕后处理所有许可。无需管理和暴露访问密钥。

### 秘诀:依靠加密！

Kubernetes 通过以 YAML、Terraform 和其他配置格式对所有基础设施选择进行编码来增强 IaC 工作流。这可以确保您的基础架构 100%可复制，即使一个集群在一夜之间消失。请记住，应用程序需要访问机密，如凭证、API 密钥、管理员密码和其他一些敏感信息才能正常工作。不要试图将这些凭证签入 IaC 存储库，因为这会将它们暴露给任何能够访问 Git 存储库的人。相反，加密您的秘密，并将其安全地签入您的存储库，这样您就可以使用一把钥匙来解锁您的 IaC 呼吸系统，并拥有一个完全可复制的基础架构。

## 外卖食品

底线是，应用程序在不断变化，这意味着安全性也在不断变化。Kubernetes 让您能够根据最佳实践优化安全设置，从而减轻了攻击的严重性。这意味着你可能犯的最大的安全错误就是没有遵循它们！

[fair winds Insights](https://www.fairwinds.com/insights)，我们的安全和治理平台，可以提供帮助。它大规模自动化安全，集成左移策略并降低风险以支持创新。免费提供！[拿过来。](/coming-soon)要了解有关这些最佳实践的更多信息， [请阅读我们关于该主题的全面白皮书](https://www.fairwinds.com/kubernetes-best-practices-comprehensive-white-paper) 。

[![Download the Kubernetes Best Practices Whitepaper](img/ff6b63b515c18edd13b80bc25f17c2de.png) ](https://cta-redirect.hubspot.com/cta/redirect/2184645/e68d92d3-c876-4525-b775-6123e46c7212)