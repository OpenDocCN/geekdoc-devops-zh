# 永远不要在 Kubernetes 第 4 部分:三个 K8s 效率错误

> 原文：<https://www.fairwinds.com/blog/3-kubernetes-efficiency-mistakes>

 正如我们在这个系列的第一篇文章中所概述的，有些事情你绝对不应该在 Kubernetes 上做。[duck bill Group 的首席云经济学家 Corey Quinn](https://twitter.com/QuinnyPig) 与 Fairwinds 的总裁 Kendall Miller 和 Fairwinds 的高级站点可靠性工程师 Stevie Caldwell 进行了一次生动的对话，讨论了开发和运营团队如果想从领先的容器编制器中获得最大收益，就不应该在 Kubernetes 中做的一些事情。如果你想最大限度地提高 Kubernetes 的效率，以下是你需要注意的。

(请记住，这是绝对不应该的，所以标题可能看起来有点奇怪，有点明显，甚至令人惊讶！)

## 1.将工作负载放在德克萨斯大小的房子里

这个 K8s 效率错误和下一个确实密切相关，当将工作负载放在“德克萨斯州大小的房子”中时，它真正归结为爆炸半径，即如果(或当)出现问题时，您正在运行的东西会受到多大影响。如果有几个大型工作负载正在运行，其中一个出现故障，很多事情都会受到影响。因此，虽然您可以将工作负载放在巨大的“房子”中，但您也需要让工作负载意识到这些事情。换句话说，了解如果您的工作负载下降，将会影响什么。另外，不要忘记考虑如果一切都不顺利，需要什么才能让一切恢复正常运行。

当人们在 Kubernetes 上部署工作负载时，他们最头疼的事情之一就是了解他们的应用程序需要什么。决定哪种节点或实例类型最适合它们正在运行的内容是一项挑战，知道发出哪种资源请求以及将哪些资源分配给它们的应用程序也是一项挑战。很多人一开始就分配过多，然后集群中的节点比需要的更多或更大。Kubernetes 根据您的请求来调度您的工作负载，因此，如果您请求 200 毫 core，而您只使用了 8 个，则不会调度任何与此相冲突的其他任务，并且您将拥有远远超过您的应用所需的扩展空间。在这种情况下，您可能能够有效地运行您的应用程序，但是您将失去 Kubernetes 部署的效率。

## 2.将工作负载放在一个小房子里。

我们经常建议，在您学习和开始使用 Kubernetes 时，从小处着手是一种很好的开发实践。一开始，在受限制的环境中开始构建东西是有意义的，如果需要，您可以随时扩展。重要的是要记住，这是一个拐杖，你应该只需要当你开始；你最终会耗尽这个计划的成长空间。

不过，请记住，从小处着手和将明显需要更多计算能力的东西放在尽可能小的空间中是有区别的。如果你这样做，它将一直以 100%的 CPU 运行，但仍然不会工作。虽然没有一种尺寸适合您要做的所有事情，但您不会因为将工作负载放在无法有效工作的地方而节省资金或感到沮丧。

不要使用太大的房子，否则你会牺牲效率(和$$)也不要使用太小的房子，否则你会过度利用一个节点，由于资源匮乏而导致一连串的故障。

## 3.忽略自动缩放

有很多人在使用云，使用像 Kubernetes 这样的云原生技术，这使得像扩展这样的事情变得容易。然而，它们不是自动缩放的。这是云计算最大的承诺之一。不要移动到 Kubernetes 并关闭自动缩放。它真的很擅长自动缩放，这是你在使用 Kubernetes 时应该利用的。

人们往往对实现自动扩展非常感兴趣，这很重要，因为当资源需求激增时，它可以让您的应用程序保持在线。不幸的是，人们总是忘记弄清楚如何明智地缩减规模，因为失败的模式就是多花一点钱。然而，在过去的一年中，许多环境的用户流量直线下降，而基础架构成本却保持直线上升。为什么？因为他们从未真正测试过缩小规模，所以没有发生。不要忽略自动缩放，但是也要花时间确保如果有一半的节点消失，您的环境不会爆炸。自动缩放当然可以提高你的效率，所以花时间去实现和测试它，永远不要忽视它。

[观看完全娱乐性的点播网上研讨会](/never)了解在 Kubernetes 上你还应该做些什么。

[![Never Should You Ever in Kubernetes](img/257f64e9f957e014bd33223364c91406.png)](https://cta-redirect.hubspot.com/cta/redirect/2184645/3cf32ad5-63de-4c49-92fb-1b13a93ade0b)