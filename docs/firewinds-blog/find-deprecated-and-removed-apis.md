# 在 Kubernetes:Pluto 简介中查找不推荐使用和删除的 API

> 原文：<https://www.fairwinds.com/blog/find-deprecated-and-removed-apis>

 ## 资源:

## 视频记录:

下面是对我们的开源工具 Pluto 的一个简要概述。

## Pluto:查找已弃用和已删除的 API 版本

Pluto 是一个实用程序，它可以帮助您在 Kubernetes 集群中找到不推荐使用和删除的 API 版本。因此，随着时间的推移，Kubernetes 不得不放弃不同的版本，以便我们能够向前发展，只使用最新的版本，而不必随着时间的推移支持一切。因此，有一个过程可以做到这一点，一个 API 版本被弃用，并最终从 API 中实际删除。因此，Pluto 会将您的基础架构视为代码或您的掌舵图，或者您在集群中安装的掌舵图，并告诉您是否有那些最终将被删除的过时版本，以便您可以找到它们并修复它们。

## 冥王星是如何工作的？

Pluto 是一个命令行工具。您可以用几种不同的方式安装它。所以我们有一个 ASDF 插件。我们可以把 ASDF 接上，加上冥王星。或者我们可以在 Golang 中构建二进制文件并安装它。我们刚刚做了一些更新，所以你现在可以去安装它，如果你熟悉这个命令。或者，您可以从 GitHub 发布页面上获取二进制文件，并将其放在您的路径中的某个位置。这是冥王星双星。我们要做的第一件事是检测文件。因此，在我们的 Pluto 存储库中，我们有一些测试 Pluto 的测试文件，但是您可以针对任何部署到 Kubernetes 的平面 YAML 文件运行这些文件。所以我们要检测文件。我们将在这里获得一些信息，包括对象的名称、对象的种类、对象的当前 API 版本，以及哪个 API 版本取代了过时的版本。我们在这里可以看到它是否被删除，是否被弃用。

因此，我们在这里看到，扩展 v1 beta one 部署在 1.9 版本中被弃用，并在 1.16 版本中被删除。我们可以通过向冥王星传递另一个标志来查看该信息。如果我们知道它在哪个名称空间，它会告诉我们它何时被弃用，何时被删除，它在哪个名称空间。这就是冥王星的核心所在。检查一下你的文件，确保不会有什么东西被否决。我们在这里看到，我们也有一个非零的退出代码。因此，我们可以将它插入到 CI 系统中，如果我们不赞成使用 API，就会导致构建失败，有几个标志可以帮助调整该行为，以便您可以按照自己想要的方式使用它。

冥王星做得很好的第二件事是，它查看位于你的集群内的释放对象中的掌舵清单。因此，如果您正在使用 Helm，并且想要查看您的集群中已经部署了哪些 API 版本，我们可以使用 detect Helm 命令。同样，我将在这里查看宽输出，因为我认为它的信息量更大一些。我们在这里看到，我们有一个头盔版本，其中有一些过时的版本。所以这里有一个政策 v1 beta 的 pod 中断预算。这被政策 v1 所取代。V1 beta one 在 1.21 中被弃用，并将在 1.25 中被删除。所以在我升级到 Kubernetes 1.25 之前，我需要更新这个对象的 API 版本。

现在你可能会问为什么我们只看舵图？Kubernetes 很棒，因为它可以在 API 版本之间进行转换。因此，如果我让 Kubernetes 给我一个部署，它会告诉我我在寻找什么 API 版本，而不管哪个 API 版本被部署到集群。因此，我们必须看一些更明确的东西，解释对象是如何部署到集群的。因此，在这种情况下，Helm 版本对于在部署到集群中时部署的 API 版本非常明确。这就是为什么我们只用头盔。

所有这些信息都可以在我们的文档页面上找到。所以如果你去 pluto.docs.fairwinds.com，你可以看到我们这里有所有这些信息，它讲述了我们为什么建造冥王星，它的用途，库伯内特的弃用政策，以及冥王星的一些不同用法。简而言之，这就是冥王星。谢谢你们的倾听，祝你们一周都过得愉快。

[![Use Fairwinds Insights for Free Security, Cost and Developer Enablement In One](img/7c86296320eb01b215d8e2755e9c5b9d.png)](https://cta-redirect.hubspot.com/cta/redirect/2184645/34aa4987-a1f9-438a-a145-d7d82d5c479a)