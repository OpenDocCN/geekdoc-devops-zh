# 为什么自动化基础架构至关重要，以及它如何节省时间

> 原文：<https://www.fairwinds.com/blog/why-automated-infrastructure-is-key-and-how-it-saves-time>

 你需要有经验的人来支持你的基础设施和解决复杂的问题。也就是说，雇佣内部专家只是简单地按下相同的按钮来进行日常升级和按需扩展您的基础架构是没有意义的。如果有一天那些内部专家决定离开，会发生什么？

这就是自动化基础设施至关重要的原因。这是为了节省时间，同时减少依赖性。让我们更详细地研究三个方面:配置管理、部署自动化和自动扩展。

## 配置管理

配置管理曾经侧重于应用程序，但今天您的基础架构需要处于配置管理之下，以便您可以内置容错功能。以  [AWS](https://aws.amazon.com/) 为例，如果您的基础架构处于配置管理之下，并且您可以以标准、自动化的方式运行它，那么您只需决定在另一个地区(比如美国西部)重建您的基础架构，您的基础架构就会自动重建。

如果您的基础设施发生变化，您的应用程序可能会崩溃，反之亦然。在过去，系统操作员会对服务器进行更改，然后开发人员可能会部署不起作用的代码。当基础设施不在配置管理之下时，代码并不总是随着基础设施的改变而被测试。

同样的原则也适用于 DevOps，这里的一切每天都在变化。没有什么是一成不变的，所以最好留在前线。如果没有自动化，您需要手动升级，这可能每天需要 30-40 分钟，并且会极大地消耗您的资源。

## 部署自动化

如果您的集群处于配置管理下，并且您使用类似于[kops](https://github.com/kubernetes/kops)([kubernetes-ops，用于从命令行部署 Kubernetes 集群的一站式开源解决方案](http://blog.reactiveops.com/kops-the-kubernetes-deployment-game-changer))的工具，那么升级是自动的，可以节省大量时间，并减少人为错误。

这给我们带来了一个关于部署自动化的更大的讨论。

您的应用程序和基础架构必须融合，这就是 DevOps 的用武之地。自动化您的应用程序部署增强了您的基础设施。如果应用程序代码被容器化，并且每次都以相同的方式部署到您选择的环境中，那么您就不必担心哪里出了问题。自动化为您提供了一条清晰的道路，如果您遵循这条道路，您将快速识别问题并追踪问题的根源。

自动化部署还节省了新开发人员的入职时间。开发人员过去常常编写应用程序，测试它们，将它们加载到服务器上，配置它们，运行它们，然后在它们被破坏时修复它们。这是一个耗时的过程。现在开发人员可以处理代码，剩下的就交给自动化了。

## 自动缩放

自动伸缩有助于确保拥有正确数量的实例来处理应用程序的负载。您可以在自动缩放组中指定最小和最大实例数(或特定的实例数)，自动缩放会自动确保您的组符合这些标准。

假设您将所有应用程序容器放在一个集群中，完全填满了集群。如果添加新资源的过程不是自动化的，操作员必须启动群集中的另一个节点，然后您才能开始使用这些资源。这个手动过程需要时间。如果这个过程是自动化的，您可以用一堆容器填充您的集群，当它们不再适合时，集群知道需要更多的资源，并将自动启动新的节点。

[Kubernetes](https://kubernetes.io/) 可以在容器级别自动扩展您的基础设施。假设您在一个群集中有 10 个节点，您通常只需要运行应用程序的 10 个副本。你的广告刚刚在《早安美国》播出，突然之间，你的网站访问量一飞冲天。您的应用程序的这 10 个容器已经不够用了，但是在您的 10 节点集群上仍然有足够的空间(资源)可用。Kubernetes 可以在 15-30 秒内扩展一个容器，而不是扩展一个可能需要 5-7 分钟的新实例。您可以根据需要扩展您的基础架构，它所做的只是在集群中放置更多的容器。只要你有足够的空间，它替你处理你的成长需求。

## 容错

如前所述，容错也很重要。如果操作人员没有注意到某些东西，会发生什么情况？如果你不知道有一个交通高峰即将到来，你当然不能超越它。像 Kubernetes 这样的自动化容器集群会为您注意到行为的变化。

假设您在某个应用程序容器上收到大量请求，它开始耗尽内存并死亡。如果这种情况发生在常规的服务器实例上，您的应用程序也会死亡。如果您有自动化的集群，那么您也有自动化的容错能力。如果您的容器不堪重负，耗尽了内存并死亡，集群会注意到(它知道观察这种情况)，它会自动旋转一个新的副本。

Kubernetes 可以在实例级别做同样的事情。假设您有一个很大的硬件资源池，AWS 终止了一个实例。如果没有自动化，如果服务器停止运行，而有一堆容器在上面运行，那么必须有人首先注意到，然后想出该做什么(启动一个新的集群节点并重新调度容器)。通过自动化，Kubernetes 将识别问题，抢先启动新的集群并转移资源。Kubernetes 还将等待集群是否恢复，如果恢复，它将取消节点扩展，以免浪费资源。这种自我修复意味着许多问题都可以高效、经济地解决，无需人工干预。

此外，Kubernetes 有一个称为  [的 Kubernetes 集群联盟](https://v1-16.docs.kubernetes.io/docs/tasks/federation/set-up-cluster-federation-kubefed/)，它使用户能够将不同地区的多个集群组合成一个逻辑计算联盟。这种联合简化了高可用性、地理上分布的服务的部署。如果整个地区都瘫痪了，那么你所有的流量都会转移到其他地区。

***接下来是[第 3 部分—受监控的基础设施并不好玩…但它很重要！](http://blog.reactiveops.com/monitored-infrastructure-is-not-fun-but-its-critical)***