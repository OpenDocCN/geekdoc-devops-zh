# 正确的 Kubernetes 配置是提高效率和可靠性的关键

> 原文：<https://www.fairwinds.com/blog/correct-kubernetes-configuration-is-key-to-better-efficiency-and-reliability>

 尽管容器安全性通常被认为是 Kubernetes 中最紧迫的话题，但它与效率和可靠性问题有着千丝万缕的联系，这是云本地世界中的两个关键要素。为了有效地运行 Kubernetes，组织必须努力确保默认情况下工作负载既可靠又高效。因为即使 Kubernetes 在出现问题时提供了某种程度的自我修复，应用程序也需要适当的设置才能正常工作，并充分利用底层 Kubernetes 平台的内置功能。

当可靠性和效率问题没有通过最佳实践得到妥善解决时，成本优化和性能等关键要素就会受到严重影响。可靠性和效率这两个领域需要被视为一个相互关联的挑战，通过适当的 Kubernetes 配置的单一策略来解决。通过定期检查工作负载的总体可靠性，从业者可以确保他们的组织保持资源效率和成本效益。这样，错误配置就成了可靠性和效率问题的核心，这是运行 happy Kubernetes 集群的两个关键属性。

> 我们在最新的白皮书[“好的，坏的&错误配置】](https://www.fairwinds.com/kubernetes-good-bad-misconfigured-white-paper)中详细讨论了这个问题，您可以随时免费下载。

## 结构管理

业内通常称之为配置管理或基础设施代码(IaC)扫描，这个过程在只有几个 Kubernetes 集群的小团队中可以手工完成；然而，随着组织试图扩展，许多开发人员部署到多个集群，这个问题变得更加具有挑战性。如果没有 IaC 扫描或某种类型的配置管理，DevOps 团队以及平台和安全负责人可能会很快失去对正在发生的事情的可见性和控制。这一现实表明需要自动化和策略来加强一致性，并在整个组织中提供适当的防护。

### 效率

IaC 扫描以多种方式影响 Kubernetes 的效率。首先，它提供了识别时间、金钱和专业知识等资源浪费的可见性。Kubernetes 工作负载的错误配置通常涉及低效的计算资源供应，从而导致云计算的巨额账单。如前所述，为了最大化工作负载的 CPU 效率和内存利用率，团队需要适当地设置资源限制和请求。但是这里有一个问题——知道为流畅的应用程序性能设置正确的限制是非常棘手的。这就是可见度发挥作用的地方。

获得应用程序资源使用情况的可见性可以帮助团队更好地了解他们的应用程序在不同的 CPU 和内存设置下的性能。然后可以对这些进行调整，以改善应用性能或提高 Kubernetes 计算资源的效率，最终帮助组织节省云计算资金和数据中心容量。

### 可靠性

在 Kubernetes 中，可靠性就是构建一个稳定的平台，这样开发团队就可以简化他们的开发过程，更快地发布应用程序。配置管理(IaC)会影响可靠性，因为它为开发运维团队提供了避免停机和生产事故的方法。平台工程和运营团队负责监控 Kubernetes 集群的运行状况，这是通过一套最佳实践来实现和协调的。平台工程团队必须与开发团队合作，以确保从一开始就可靠地配置工作负载——说实话，Kubernetes 的错误配置经常发生。

Kubernetes 提供了一个框架，在这个框架中，用微服务和容器构建分布式系统，以便可靠地运行应用程序。这种模式意味着不同的团队拥有不同的堆栈层，这是 Kubernetes 服务所有权的一个基本概念，开发人员专门负责通过适当的配置将他们的应用程序下载到 Kubernetes。这种普遍的类似 DevSecOps 的服务所有权模型将运营团队从处理部署配置中解放出来，并允许他们专注于策略实施和可操作的开发人员反馈。

通常在 YAML 文件和舵图中进行的工作负载配置会影响服务的安全性和可靠性，以及集群中工作负载的效率。在组装一个稳定可靠的 Kubernetes 集群时，需要考虑许多因素，包括应用程序更改和集群配置变更的潜在需求。这些考虑事项包括设置资源请求和限制、使用正确的指标自动扩展 pod 以及使用活跃度和就绪性探测器。

## 正确的配置

IaC 扫描解决方案，如在 [Fairwinds Insights](https://www.fairwinds.com/insights) 中可用的那些，可以在开发人员提出拉取请求时检查 YAML 和舵配置。与代码扫描解决方案等传统基础设施一样，Insights 会检查安全违规配置，如权限提升。该软件还进一步整合了对平台工程团队的效率和可靠性检查，他们依赖这些检查来运行稳定和可扩展的基础设施。

以下是一些支持正确配置的可靠性检查示例:

*   必须对资源消耗设置限制，以防止 pods 消耗一个节点上的所有可用内存和 CPU，否则称为“噪音邻居问题”
*   跨多个节点和可用性区域的容器应该在云中进行调度，以实现高可用性。
*   应该使用反关联性来约束哪些节点有资格基于 pod 标签而不是基于节点进行调度。
*   必须通过部署冗余实例来规划容错，以避免单点故障。
*   应该应用活动和就绪探测来确保服务的可用性并检查集群性能。

因为配置错误非常普遍，所以只有遵循这里概述的最佳实践，才能构建稳定、可靠和安全的集群。这种级别的治理只能通过值得信赖的合作伙伴来实现，他们精通统一团队、简化复杂性和利用 Kubernetes 的专业知识来节省时间、降低风险和放心配置的流程。

## 专业知识和伙伴关系

[Fairwinds Insights](https://www.fairwinds.com/insights) 提供这种水平的专业知识和合作关系。作为 Kubernetes 的安全和治理平台，Insights 为 DevOps 团队提供了一个可扩展性、可靠性、资源效率和安全性的安全网，同时也使开发人员能够更快地创新和交付。

> 使用 Fairwinds Insights 在一个平台中免费获取 Kubernetes 安全性、成本分配和规避、合规性和护栏。

然后，DevOps 团队可以防止整个 CI/CD 管道中的错误配置，并向开发人员提供补救建议，无需人工干预。借助 Fairwinds Insights，管理整个企业中的多个集群和团队变得更加容易，而且在许多情况下是可能的，因为它将开源工具操作到一个平台中，以实现更好的监督和管理。

要了解更多信息，请查看我们关于 Kubernetes 错误配置的白皮书。你可以随时在这里免费下载。

[![Just Posted: Kubernetes Benchmark Report 2023](img/ac3f87548e14243ac3414b06e023028d.png)](https://cta-redirect.hubspot.com/cta/redirect/2184645/df6709b9-c7f5-4c1a-8bf4-315f56b16325)