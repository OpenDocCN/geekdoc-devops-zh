# 开源与商业软件:为什么你不能(总是)负担得起免费

> 原文：<https://www.fairwinds.com/blog/open-source-vs-commercial-software-why-you-cant-always-afford-free>

 当构建一个应用程序时，通常最重要的技术决策归结为自己构建什么，以及在哪里依赖第三方。由于充满活力的开源生态系统，现代团队可以专注于提供让用户满意的功能，并使他们的产品从竞争中脱颖而出，依靠第三方来完成他们应用程序中乏味的样板部分。

但是，一旦您决定为应用程序的某些关键任务部分采用第三方软件，比如数据库、身份验证机制、安全审计或计算基础设施，您仍然需要做出重大决定:

> 你想收养一些免费的东西，并依靠你的智慧和一群志愿者来支持你吗？或者你愿意付钱给一个合作伙伴来帮助确保你的成功？

您可能会倾向于“免费”，在某些情况下，这确实是有意义的，尤其是对于较小的、约束良好的问题。但是在很多情况下,“免费”带有一个大大的星号——你会倾向于用比金钱更昂贵的东西来购买免费软件:你的时间。您将失去商业合作伙伴所能提供的大量安全保障。

十多年来，我一直在开发商业软件，从 FAANG 企业到两个人的创业公司。我注意到早期的架构决策——通常是为了发布 MVP 而仓促做出的——通常会产生巨大的后果。我的偏见通常倾向于快速实现价值的自由软件，在某些情况下，这种偏见给我、我的团队和我公司的底线带来了真正的痛苦。

让我们深入了解自由软件的一些隐性成本。

## 成本#1 -设置

### 总成本:固定的工程周数

用开源解决一个复杂的问题可能是困难的、乏味的，并且容易出错。需要做出艰难的决定:您需要决定使用哪些包，如何将它们集成到您的堆栈中，以及如何根据您的需要对它们进行最佳配置。

你需要从深入理解软件开始，但是仅仅复制/粘贴快速启动说明是在自找麻烦(参见成本#3)。如果软件足够复杂，您可能希望指定一个或多个团队成员成为您的常驻专家。

你还需要弄清楚如何在软件上培训更大的组织。这可能很棘手，尤其是当软件影响到许多不同的角色时(例如，sre、开发人员和经理)。新员工可能不熟悉该软件或您的特定实例，因此您需要一个过程来让他们在未来入职。

您可能还需要提供一些额外的基础设施来运行软件。像 Kubernetes 这样的计算平台，当与一个[包管理器](https://helm.sh/)结合时，可以极大地简化这个过程；但是不管怎样，要准备好在您的环境中引入更多的复杂性。

最后，您可能需要花时间调整您的设置，以适应您组织的环境和需求。在这里很难判断什么时候你已经“完成”了——仅仅因为软件在工作并不意味着它是稳定的或安全的。

有了商业合作伙伴，许多设置成本就消失了。您的合作伙伴将拥有一个完整的专家团队，他们可以为您的环境提供最佳设置建议。他们将有一个专注于创造快速“价值实现时间”的产品团队，并将提供软件和服务的组合来帮助您快速启动和运行。如果是在 SaaS，你完全不用担心基础设施的复杂性。

## 成本#2 -维护

### 总成本:每月不可预测的工程周数

一旦你部署了一个新软件，维护成本很难估计或预测，但它们往往分为两类:**维护**和**扩展**。

在**维护**方面，至少，你需要确保定期下载和应用更新。这不仅仅是为了获得最新的特性——它还确保了错误和安全漏洞在被发现后很快得到修复。

您还需要为使用软件时出现的自发问题做好准备。您的环境在不断发展，工程师可能会开始以新的和意想不到的方式使用软件。如果软件开始变慢、崩溃或占用计算资源，你就需要改变优先级，立即投入一些工程时间来处理这个问题。

但是大部分的维护成本将来自于扩张。通常，现成的开源软件可以很好地解决单一环境中的小而简单的问题。但是对于跨越多个应用程序、集群或云环境的更大问题，现成的解决方案根本行不通。

在这些情况下，您需要投入大量精力来扩展和维护开源解决方案——随着您的团队的成长和应用程序的发展，您的需求也将随之发展。您可能需要与其他软件集成，或者启用其他安全功能(例如，满足 SOC2 或 HIPAA 等合规性标准)。如果你的团队或客户需要一个新的特性，你需要找时间来开发它；如果软件影响了大量不同的角色或利益相关者，这可能会成为一个巨大的负担。

有了商业合作伙伴，90%的维护成本就消失了。商业合作伙伴尤其受到激励，以帮助具有复杂环境的大客户，确保软件在基础设施复杂性和组织规模方面高度可伸缩。

对于 SaaS 平台，更新将自动应用；但即使在自主托管的情况下，您的合作伙伴也会为您提供清晰的升级路径，并让您知道哪些升级至关重要，哪些可以推迟。如果出现任何自发的问题，整个团队都会迅速行动起来，尽快解决问题。

此外，您的合作伙伴将根据客户反馈定期开发新功能。他们的产品将非常适合各种环境。作为合作伙伴，您将对路线图施加一些影响。

## 成本#3 -安全性和可靠性

### 总成本:无限

除了操作自由软件所涉及的劳动负担之外，你还得担心潜在的灾难。为了避免重大失败，你应该问几个问题:

*   如果失败，后果会是什么样？

*   它能在多大程度上与我们的环境相适应？

*   一切都安全配置了吗？

*   我们是否备份了任何相关数据？

*   我们如何确保一切按预期继续工作？

*   我们有监控和警报吗？

根据您具体部署的内容，您可能会遇到更多“未知的未知”。但是一般来说，有三种主要的故障模式你应该担心:

*   **安全性** -如果服务配置错误，攻击者会做什么？

*   **数据丢失** -如果底层数据被擦除，您能轻松恢复吗？

*   **停机时间** -如果服务停止工作，会对您的客户或团队产生怎样的影响？

这里的关键词是风险。开源软件通常按原样发布，这意味着理解软件的来龙去脉取决于您。即使您的团队已经搜索了文档，也有很大的机会让未记录的行为或无意的错误咬您一口。

再一次，有了商业伙伴，这些顾虑几乎都消失了。您的合作伙伴受到激励，每天都在确保他们的产品安全可靠。商业合作伙伴对他们的软件承担全部责任，承担你自己承担的风险。任何问题都比你的问题更有可能影响他们的底线。

## 案例研究- Fairwinds Insights

在 Fairwinds，我们建立了一个审计 Kubernetes 集群的商业平台- [Fairwinds Insights](/insights) 。我们的很多插件都是开源的，比如 [OPA](https://www.openpolicyagent.org/) ，Aqua 的 [Trivy](https://github.com/aquasecurity/trivy) 或者我们自己的 [Polaris](https://github.com/FairwindsOps/polaris) ，所以我们在销售过程中经常会遇到的一个问题是:

> “为什么我不能自己免费部署所有这些工具？”

当然，答案是你可以自己部署开源软件，但它肯定不会是免费的。我们已经花费了超过 10，000 个工程师小时来操作这些工具——设计一个通用的报告模式和转换层，构建仪表板，集成 GitHub 和 Slack 等工具，并设计工程师友好的工作流。由于这项工作，Fairwinds Insights 用户在第一天就可以获得有关其 Kubernetes 集群的宝贵信息，并可以继续轻松扩展其使用。

> 寻找一个完整的 Kubernetes 治理平台？Fairwinds Insights 是免费的。 [今天就开始](https://www.fairwinds.com/coming-soon) 。

假设你选择自己做所有这些，让我们看看隐藏的(和不那么隐藏的)成本在哪里。

### 设置

#### 总费用:每份报告大约 1 个工程师周

审计 Kubernetes 基础设施最困难的部分就是简单地确定使用哪些工具。我们在野外发现了几十种开源审计工具，并花了几个月的时间逐一查看，以便为每种类型的审计找到最佳选择。在我们还没有找到好的解决方案的地方，我们已经建立了自己的解决方案。借助 Fairwinds Insights，我们精心打造了一个强大的、经过充分研究的、不断发展的审计工具组合，可以满足任何组织的需求。

我们还构建了一个安装程序，将所有这些审计插件打包在一个单独的舵图中，并以统一的方式运行它们。这听起来可能很简单，但以 Trivy 为例:默认情况下，Trivy 运行在命令行上，可以检查单个容器图像中的 CVE。为了完全实现 Trivy，我们构建了一个 CronJob:

*   按照可配置的计划运行 CLI(通常每小时一次)

*   使用 Kubernetes API 收集集群中运行的映像列表

*   汇总结果，消除不同映像之间共享的重复漏洞

*   维护最近扫描过的图像列表

*   利用该列表确定新扫描的优先级

我们产品组合中的每个审计工具都有一个类似的包装器来完全操作它。我们已经投入了数百个工程师小时来构建和维护一个高度可配置的单行安装程序，它可以在您的 Kubernetes 集群中以一致的方式运行多达 12 种不同的工具。

最后，我们花了几周时间研究每一个工具，并对如何推广它们形成了强烈的意见。例如，有许多不同的方法来部署 OPA 来审计 Kubernetes。但是在研究了最佳实践和实际实施后，我们选定了一个解决方案:

*   将策略存储在策略代码库中

*   将这些策略与远程服务器同步

*   将策略联合到您机群中的每个集群

*   允许您在 CI、准入控制和集群内审计中运行相同的策略

*   允许您根据上下文打开和关闭特定的策略

自主开发的解决方案可能会错过这些最佳实践中的一些或大部分。

> Fairwinds Insights 社区版永远免费使用。在此 注册 [试用完整版 30 天。在 GKE、阿拉斯加或 EKS 进行测试，或者在测试集群上运行。](https://insights.fairwinds.com/auth/register/)

### 维护

#### 总成本:每月 0.5-2 个工程师周

我们的每个审计工具都相当简单，可以临时运行，以获得集群的时间点快照。例如，您可以运行 `polaris dashboard` 来查看您的每个工作负载的列表以及如何改进它们。

但是，如果您关心安全性和合规性，浏览临时报告是不够的。您需要定期运行审计，将结果存储在某个地方，并跟踪随时间的变化。这将涉及提供存储(存储结果)、一些脚本(区分不同的审计)以及一些第三方集成(当新问题出现时发送警报)。您需要确保定期更新您正在使用的审计工具。而且，当这些工具中的一个更新可用时，您将需要相应地重写所有附加的基础结构。

因此，仅仅为了让定期审计运行并得到持久的结果，就必须维护大量额外的代码和基础设施。这是在您的安全、开发和运营团队开始要求额外的功能之前——当他们想要将项目分配给特定的人时会发生什么？在空闲时获得提醒？看历史趋势？在 GitHub 中制造问题？

Fairwinds Insights 团队不断与客户交流，构建出最受欢迎的功能。我们构建了用户界面来帮助:

*   运营团队了解哪些资源不符合他们的策略

*   当他们的 CI 渠道发现配置问题时，开发人员会深入研究

*   工程经理一眼就能了解他们的集群有多安全、高效和可靠

### 安全性和可靠性

#### 总成本:无界

如果你只是在运行免费的开源工具，那就要由你来确保它们真的在运行。如果其中一个审计开始失败，或者悄悄地跳过了基础设施的某个部分，您可能会以覆盖范围的缺口而告终。无意中的失误可能会使您不符合规定，或者更糟，导致安全违规。

如果您正在持久地存储审计数据(您应该这样做！)，丢失这些数据会有什么后果？你需要确保它得到适当的备份。

此外，虽然这些工具背后的开源维护者可能愿意帮助你解决出现的问题，但他们没有义务或动机这样做。他们是志愿者，经常会超负荷工作。如果您遇到了麻烦，您的团队可能需要深入研究其他人的源代码来试图发现问题。

Insights 团队围绕应用程序建立了全天候监控和警报，任何停机都会得到即时响应。当客户有问题时，我们通过电子邮件、zoom 和 Slack 提供支持。我们受到强烈的激励，以确保我们的用户从产品中获得价值，并确保他们的数据安全。

## 你负担不起免费的

总而言之，使用现成的开放源码来解决一个任务关键型问题是有很大成本的。您的团队将:

*   花大量的时间学习和部署软件

*   专注于修复、升级和增强您的部署

*   总是面临停机、数据丢失和安全漏洞的风险

> 如果让我用一个词来概括部署关键任务开源软件时选择商业合作伙伴的原因，那就是:**信任**。

开源软件按原样提供，由志愿者维护；虽然有些人会尽力帮忙，但他们没有义务或动机来教育你，回答你的问题，或支持你的特殊需求。

为软件付费恰好符合激励机制。不要把许可证看作是为“额外的特性”付费——把它看作是一种合作关系。商业许可证为您使用软件提供了固定的、可预测的、可衡量的价格，取代了自助服务的隐藏的、可变的成本。商业伙伴关系还带来了额外的好处，如对路线图的影响，以及当您有问题或疑问时的快速支持。

最重要的是，您的工程师可以自由地专注于重要的事情——为您的用户提供有价值的功能。

[![The Hidden Cost of Open Source Read More](img/130394af89e424f5d8424f3cf7407c11.png)](https://cta-redirect.hubspot.com/cta/redirect/2184645/a8b48459-fd5e-4b25-9e90-523dd986fbca)