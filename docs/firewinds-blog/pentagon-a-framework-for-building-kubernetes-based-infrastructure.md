# 五角大楼更新:构建基于 Kubernetes 的基础设施的框架

> 原文：<https://www.fairwinds.com/blog/pentagon-a-framework-for-building-kubernetes-based-infrastructure>

 Pentagon 是一款开源工具，可以显著减少创建基础设施所需的手动步骤。它节省了时间，减少了错误，极大地提高了标准化和一致性。最棒的是，T2 组织之外的工程师可以使用它。

那么五边形到底是什么？

简而言之， [Pentagon 是 ReactiveOps 的开源框架，用于以 Kubernetes 代码的形式构建可重复的基于云的基础设施。](https://github.com/reactiveops/pentagon)五角大楼在自己的 AWS 账户中以自以为是的方式创建香草 Kubernetes 基础设施，为 Terraform、Ansible 和 [kops](https://github.com/kubernetes/kops) (在 AWS 中管理基础设施和创建 Kubernetes 集群的 ops 工具)生成配置文件。这些配置文件允许您创建一个 Kubernetes 集群，包括一个新的 VPC 和一个 VPN。

## **为什么我们在顺风处使用五边形**

我们创建了五角大楼，因为我们想要一种快速建立统一基础设施的方法。当我们管理客户的基础设施时，他们所有的代码都是一样的，工具也是一样的。因此，出现意外、陷阱和偏离最佳实践的情况会更少。

我们以 AWS 为例。在几个月内从 AWS 进入生产准备状态几乎是不可能的，尤其是当你从零开始的时候。如果你想自己建立一个像五角大楼那样的基础框架，需要几个月的时间。有了五角大楼，你可以加快整个过程。

***五角大楼如何运作***

简而言之，五角大楼生成配置文件。如果你想为你的基础设施定制五边形，你所需要做的就是改变配置文件或者添加新的配置文件到你的 Terraform 或者 Ansible。你可以把五边形工具创建的目录变成你想要的样子。

***健壮的默认特性集***

使用五边形，您会得到一个具有以下默认特征的集群网络:

*   隔离多个开发/非生产环境
*   基于 VPN 的访问控制
*   跨多个可用性区域构建的高可用性配置

Pentagon 的最新版本包含了组件的概念，并且 Pentagon 本身现在可以用定义的组件类进行扩展。这意味着你可以将任意代码带入五角大楼框架，生成你希望你的组件生成的任何一组文件 [Fairwinds](/) 。

## 【Fairwinds 为何开源五角大楼

[Fairwinds](/) 是服务公司，不是产品公司。我们的核心竞争力是我们管理基础设施的能力，以及我们对云基础设施和 Kubernetes 基础设施的集体知识。我们已经在代码中定义了我们的最佳实践，并开源了我们的工具，我们的客户可以根据存储库中的代码看到这些最佳实践。

使用标准最佳实践意味着我们不必为每个新客户重新设计车轮。五角大楼使我们能够重复这一过程，以大大减少我们的管理工作。它还允许我们专注于更高价值的任务，而不是自动化的任务。

## **为什么你应该使用五边形**

***为什么用它***

对于具有一定水平的运营知识，但不想自己编写 Terraform VPC 模块或自己解决 VPN 问题的人来说，这是一个很好的起点。五边形包括电池。

当这些工具按照我们给你的步骤以特定的顺序运行时，结果就是 AWS 中的 VPC 和 VPN 以及 Kubernetes 集群。虽然 Pentagon 的设计是可定制的，但它包括适合大多数软件基础设施需求的默认设置。

***为什么过去五角大楼很难用***

当我们最初开源它的时候，五角大楼的文档是分散的，难以理解。它不是为开源用户量身定制的；相反，它是为 [Fairwinds](/) 的领域知识专家量身定制的，这些专家接受了内部培训，并且可以访问非开源的极其详细的文档。这为我们组织之外的工程师带来了巨大的学习曲线。

***为什么五角大楼今天更用户友好***

我们的目标是让那些在[顺风](/)之外、没有领域知识的人更容易开始使用五角大楼来创建伟大的基础设施。我们一直在努力让 Pentagon 对开源社区更加友好，现在 Pentagon 已经有了很好的文档记录。如今，对闭源文档的引用已经不复存在，我们已经定义并最小化了创建 Kubernetes 集群所需的步骤。

鉴于第一代五边形涉及高度手动的过程，现在你可以从最初的五边形 开始-项目 命令来配置五边形结构范围内的一切。从创建 Kubernetes 集群开始，整个过程都是自动化的。只需两个命令，您就可以到达运行 VPN 的 VPC。从那里，您可以编写一个 Python 模块来扩展 Pentagon 程序的功能。

## **用于启动和运行集群的命令**

***附加细节***

需要注意的一点是，Pentagon 是一个生成目录的 Python 程序。五角大楼本身不是目录；相反，它是一个已定义目录结构的生成器。很像 Ruby on Rails 是一个生成器。该目录定义了 Ansible、Terraform 和 kops 的一组基本配置。

还需要注意的是，Pentagon 不会自动创建 Kubernetes 集群。虽然创建 Kubernetes 集群所需的准备过程只需要两个命令，但是创建 Kubernetes 集群的过程本身要详细得多(并且需要大量的文档和 [DevOps 和 Kubernetes 专业知识](http://blog.reactiveops.com/how-we-deliver-big-even-though-were-small-with-devops-as-a-service) )。

***创建五边形项目的具体命令***

```
---
> pentagon start-project <project-name> --aws-access-key <aws-access-key> 
--aws-secret-key <aws-secret-key> --aws-default-region <aws-default-region>
> cd <project-name>-infrastructure
> make all
```

***GitHub***

反应行动/五角大楼

你可以在这里 了解更多五边形 [**入门知识。**](https://github.com/reactiveops/pentagon/blob/master/docs/getting-started.md)

## **五角大楼的未来**

我们很高兴在 AWS 中发布了 kops/Kubernetes 集群的模板化和自动化创建。 [Fairwinds](/) 也在致力于改善谷歌云平台上的谷歌容器引擎(GKE)支持。此外，我们正在开发一个流程，通过该流程，我们可以在一个五角大楼的存储库中使用多个项目和多个帐户。我们的目标是扩展我们在 kops 集群中可以做的事情，并自动启用 Kubernetes 中的关键功能。

五角大楼旨在让我们的团队快速构建许多复杂的基础设施，并安全、经济、一致地维护它们。它使我们能够从现有的代码基础开始。它允许复杂的定制，我们可以根据需要定制。 **同样重要的是，你也可以。**

有了 Pentagon，我们的团队简化了集群的创建——如果您选择利用 Pentagon 提供的所有功能，您会发现您可以为您的团队节省大量时间，并减少挫折。