# 监控和记录

> 原文：<https://www.fairwinds.com/blog/monitoring-and-logging>

 在我的运营生涯中，我有过很多关于监控和日志记录的争论。许多争论都集中在我想监控和记录“太多”的想法上。这不一定是错误的，但我一直认为它更像是“监控和记录一切”

原因很简单。当(不是“如果”)出现问题时，您将需要数据来帮助理解和排除故障。如果你不监控和记录所有的事情，那么你将永远至少部分地处于黑暗中。我确信哲学上的争论是关于永远不能真正监控一切…但我认为重点是明确的。

## 关于关键绩效指标的问题

也就是说，并不是你收集的每个数据点都是关键绩效指标(KPI ),你也不需要为每个数据点设置警报。您也不需要将所有数据保留 30 年。如果有意义，保留你的 KPI 更长时间。举例来说，你的应用程序的平均响应时间可能在一年后仍然有用，但是 web 服务器的磁盘利用率可能就没那么有用了。

我们还经常被要求推荐和实施监控。这很简单。使用类似于  datadog 和  loggly 的服务。

## 监控和日志服务

除非您的核心业务是监控/日志记录，否则您应该将此成本汇的管理工作留给真正关心它的人，因为这是他们的业务。你永远不会从监控中赚钱，与其转移你的宝贵资源，不如利用这些资源来创收。

有一个例外，那就是规模。当您运行大量系统时，许多监控和日志记录服务会变得非常昂贵。在这种情况下，规模经济可能有利于整合定制解决方案。

与古老的  [Nagios](https://www.nagios.org/) 和它的 forks 相比， [Sensu](https://sensuapp.org/) 是一个很好的警报工具，在有短暂机器的云环境中工作得更好。最大的原因是基于订阅的客户端监控和比 Nagios 更容易分配负载的能力。与 Nagios 非常相似，Sensu 没有提供跟踪和绘制收集的数据点的方法。也喜欢 Nagios，不难补充。一个不错的选择就是[InfluxDB](https://influxdata.com/)搭配  [Grafana](http://grafana.org/) 。  [石墨](https://graphiteapp.org/) 是代替 InfluxDB 的另一种选择，但是更难设置和维护。

在伐木方面，最大的打击者是  [麋鹿栈](https://www.elastic.co/products)。没有太多的大惊小怪，你可以聚集你所有的日志，并通过搜索和可视化处理它。还有一个非常好的社区可以帮助解析和分析日志格式。

## 最后

最终归结为成本。有许多设备要监控，许多日志要汇总，您可能会考虑自己运行。随着规模的扩大，服务成本会迅速增加。只是一定要记住，虽然你可以免费运行一些非常好的工具，但设置和维护仍然需要进行。如果你有员工和技能，让这不成问题的去做吧。否则，您将更好地专注于您的产品并创造收入，而不是冒险进入监控、日志记录和指标收集的兔子洞。