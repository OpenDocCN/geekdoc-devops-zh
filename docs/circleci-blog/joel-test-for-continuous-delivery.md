# 乔尔连续分娩测验

> 原文：<https://circleci.com/blog/joel-test-for-continuous-delivery/>

**来自出版商的说明:**您已经找到了我们的一些旧内容，这些内容可能已经过时和/或不正确。尝试在[我们的文档](https://circleci.com/docs/)或[博客](https://circleci.com/blog/)中搜索最新信息。

* * *

围绕更新[乔尔测试](http://www.joelonsoftware.com/articles/fog0000000043.html)或生产更多[特定用途的变体](http://simpleprogrammer.com/2015/02/16/joel-test-programmers-simple-programmer-test/)有一点家庭手工业的形成。如果你不熟悉 Joel 测试，这是 Joel Spolsky“不负责任地快速”测量开发团队质量的方法。我觉得这些读起来很有趣，并想为后一类贡献一个——专门针对持续交付的 Joel 测试(在短周期内交付可以随时发布的软件的实践)。

我真的应该注意到，这个列表甚至比那个更具体——它几乎完全专注于 web 应用程序的连续交付。手机是一个完全不同的游戏，我希望在未来写更多。尽管如此，将这个列表放在一起帮助我明确了我自己对我们在 LaunchDarkly 使用的流程的想法，更重要的是，我们为什么要做一些我们正在做的事情。

这是我对乔尔测试的看法，持续交付版。

## 1.你使用分布式版本控制系统吗？

正如 Joel 自己指出的，分布式部分并不有趣。[无论如何，每个常用的 DVCS 工作流](https://www.atlassian.com/git/tutorials/comparing-workflows/)都使用一个集中的存储库。DVCS 的有趣之处在于，它让分支和合并变得廉价。这很有趣，因为…

## 2.你使用特征分支吗？

## 3.你做基于拉式请求的代码审查和与分支构建的持续集成吗？

## 4.你有一个总是可部署的主(或发布)分支吗？

…如果有一个持续交付的主要指令，那就是主服务器必须始终可部署。它如此重要的原因是，它消除了围绕部署建立任何类型的沟通或协调过程的需要。如果你不得不在你的 Slack 或 HipChat 房间中@all 提及你的团队，并等待每个人给出解除警报，你就不能一天部署多次。

如果您能够保持 master(或者您的发布分支名称)总是可部署的不变量，这意味着您已经有了许多正确的过程。这是实现持续交付的必要条件，但不是充分条件。

特性分支、基于拉请求的代码审查和分支构建是帮助保持主可部署性的技术。它们确保没有经过充分审查和测试的代码不会被合并到 master 中。任何在这些步骤完成之前合并代码的工作流都违反了 prime 指令。

## 5.您是否每天都进行生产部署？

在 2010 年，这可能每个月都会发生。现在，每周部署是标准的，许多团队努力实现每日部署。尖端团队每天部署多次(例如，Flickr 每天部署 30-50 次)。这是一个雄心勃勃的目标——需要重大的文化变革和(在撰写本文时)定制工具。

## 6.您是否有一个暂存环境？

您的暂存环境需要尽可能接近您的生产环境。生产运行在 https 下？舞台也应该如此。在生产中使用 PubNub，Fastly，或者其他云服务？舞台也应该如此。否则，由于环境的差异，bug 会溜到生产中。分期应该是(半)稳定的。它的正常运行时间应该有几个 9。多少由你决定，但至少应该有一个 9。最好是领先的九。

此外，请注意，一个暂存环境是最低要求。理想情况下，团队中的任何人都应该能够构建一个类似生产的环境，其他人只需点击一个按钮，就可以看到完整的生产或类似生产的数据。一旦代码被推送到一个分支，团队中的任何人(尤其是非开发人员)都应该能够在几分钟内看到该代码在类似生产环境中的行为。

在我之前的一个团队中，我们建立了一个名为 Rainicorn 的系统，帮助我们实现了这一目标，这绝对改变了游戏规则。这是我开始黑暗发射时希望能随身携带的系统之一。

## 7.你使用特征标志吗？

无论您的试运行环境和测试有多复杂，生产流量都是完全不同的东西。功能标志开启了黑暗启动的能力，允许您通过逐步推出功能来降低风险。功能标志将部署与展示分开。这些步骤通常在持续部署管道中合并在一起——最好的团队理解这些是不同的步骤，并使用特性标志来区分这两个步骤。

## 8.你有跨职能团队吗(开发、设计、产品)？

如果你想每天向你的用户交付新的代码和新的价值，你需要建立一个反馈回路，在这个回路中，设计、项目管理和开发尽快地将用户的反馈整合到产品中。除非你的团队坐在一起有效地合作，否则很难让反馈环足够紧密。

## 9.你有关于生产的用户分析吗？

这又回到了拥有一个有效的反馈回路。快速行动通常意味着押注于应该建造什么以及如何建造——而其中一些押注将是错误的。如果你没有足够的数据，就不可能对正在发生的事情进行提炼和调整。用户通过使用你的产品不断地告诉你什么是有效的，什么是无效的——但是如果你没有设置用户分析(例如 Mixpanel 或 KISSMetrics ),你就没有在倾听。

## 10.团队中的任何人都可以通过一个按钮部署到生产环境中吗？

请记住，一个团队应该是一个跨职能的团体——这意味着要达到这个目标，你的设计师，你的项目经理，每个人都应该能够部署到生产中。

很少有团队能做到这一点，根据我的经验，通常有三个因素的组合在起作用:

1.  工具问题
2.  质量问题
3.  合规/法律限制

我在生产部署中看到的最常见的问题是，很难构建这样做所必需的工具。它通常需要大量的技术投资，通常是消除技术债务和支撑部署基础设施的某种组合。幸运的是，部署工具在过去几年中已经变得非常好了。我想过举出一些具体的例子，但它们都归结为 Docker。所以我就和 Docker 一起去。码头工人码头工人。

除了工具问题，最常见的反对让任何人轻松部署的理由是代码质量。质量问题通常归结为过程问题(例如，不保持主可部署性)或者(不太常见的)文化/信任问题。

我不能帮助或说太多关于(3)，除了指出，你应该推回遵守限制，如果你可以的话。在某些情况下，过于保守的建议是在不了解它们对生产力的影响的情况下做出的。萨班斯-奥克斯利法案是否意味着只有您专门的发布工程师才能部署到生产环境中？我不知道，我也不是律师，但我打赌 Docker 能帮上忙。也许微服务也是。

约翰·科杜马尔是[launch darky](http://launchdarkly.com/)的首席技术官和联合创始人。LaunchDarkly 帮助软件团队启动、测量和控制他们的特性。此前，John 是 Atlassian 的开发经理和 Coverity 的架构师。他拥有加州大学伯克利分校的编程语言和类型系统博士学位，以及哈维马德学院的学士学位。他一直在努力改进 launch crystally 的持续交付工作流程。