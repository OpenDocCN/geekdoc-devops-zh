# 组件测试与单元测试

> 原文：<https://circleci.com/blog/component-vs-unit-testing/>

测试是软件开发生命周期的重要部分。它在持续集成/持续部署(CI/CD)管道中扮演着重要的角色，使开发人员能够一致地发布可靠、有弹性和安全的软件。

测试和测试方法论有很多种:端到端测试、动态测试、集成测试、[其他](https://circleci.com/blog/testing-methods-all-developers-should-know/)。本文主要关注组件测试和单元测试。您将了解它们是什么，它们的区别，每种方法更适合的场景，以及如何自动化您的单元测试和组件测试，以便更快、更可靠地交付。

让我们从解释什么是单元测试和组件测试开始。

## 什么是单元测试？

单元测试是一种开箱测试的形式，在这种测试中，测试评估的是代码的内部工作——它的结构和逻辑——而不是它对最终用户的功能。单元测试包括测试独立于软件其余部分的单个代码段(单元)。单元测试是在与系统其余部分完全隔离的情况下创建和执行的。这种分离是[单元测试和](https://circleci.com/blog/unit-testing-vs-integration-testing/)集成测试的主要区别，后者关注的是代码单元和组件如何相互协作。

为了执行独立的单元测试，开发人员创建他们正在测试的功能需要的所有资源的模型。这确保了函数得到的输入是一致的，输出是可预测的。因为输出是可预测的，所以您可以对这些输出设置检查和验证，这样就可以快速测试对这段代码的更改。只要它通过了检查和验证，您就可以确信一切仍然正常工作。单元测试类似于并且经常与[功能测试](https://circleci.com/blog/functional-vs-non-functional-testing/)结合在一起，在功能测试中，输出与预期的结果进行比较。

单元测试是[测试驱动开发](https://circleci.com/blog/how-to-test-software-part-ii-tdd-and-bdd/) (TDD)的重要组成部分，这种方法鼓励你在编写代码之前创建单元测试。这种方法让您对预期的输入和输出有了清晰的认识，并确保只有通过测试所需的代码才能进入您的应用程序，帮助您保持专注，避免[范围蔓延](https://en.wikipedia.org/wiki/Scope_creep)。

## 什么是组件测试？

组件测试是封闭盒测试的一种形式，意味着测试评估程序的行为，而不考虑底层代码的细节。组件测试是在开发完成后，对整个代码部分进行的。

组件测试比单元测试需要更长的时间，因为组件是由多个代码单元组成的。虽然这很费时间，但仍然是非常必要的。有时单个的单元可以独立工作，但是当你一起使用它们的时候就会出现问题。

组件测试检查用例，所以它可以被认为是一种[端到端(E2E)测试](https://circleci.com/blog/what-is-end-to-end-testing/)的形式。端到端测试和组件测试复制真实场景，并从用户的角度针对这些场景测试系统。

实现组件测试是有益的，因为它可以揭示用户可能遇到的 bug 和错误。在用户知道这些错误之前捕捉并修复它们总是更好的。

有两种类型的组件测试:小型组件测试和大型组件测试。

### 小型组件测试

在小规模的组件测试中，被测试的组件仍然与系统中的其他组件隔离开来。您仍然应该利用模型和测试端点来模拟与被测试的组件相连接的组件。这种形式的测试确保组件准备好与系统的其余部分集成。

### 大规模组件测试

组件测试是在没有隔离的情况下完成的，这意味着被测试的组件可以访问外部组件。在大规模组件测试中，仍然只有主组件被测试，而不是连接的组件或者组件之间如何交互。这就是集成测试。

## 组件测试与单元测试:你应该使用哪一个？

单元测试通常是根据设计规范建立的，而组件测试是由用例组成的。

首先，开发人员根据每个代码单元的设计规范创建单元测试。您希望确保每个组件都正常工作。组件测试在测试过程中使用真实场景，这为您提供了一个很好的指示，说明软件一旦发布将会如何执行。

单元测试和组件测试是独一无二的测试方法，实际上在一起工作效果最好。开发人员在开发的同时运行单元测试。整个组件完成后，测试工程师或 QA 团队进行组件测试。

### 单元测试和组件测试用例

有些情况更适合单元测试或组件测试——它们不是同义词。

单元测试最适合系统的内部工作，比如在系统和数据库之间操作数据，或者映射 API 调用中使用的数据。组件测试在用例可以被充实和测试的地方工作得最好，就像网站或应用程序上的页面。

组件测试的另一个关键之处是当一个组件依赖于几个较小的组件或特性时。每个小功能都可以进行单元测试，但是整个组件必须在所有部分都运行时进行测试。

为了获得最佳覆盖率，您应该结合使用这两种测试方法。例如，您可以使用这两者来测试网站注册表单。表单上的字段包括名字、姓氏、电子邮件地址、密码和一个要求您重复密码的字段。然后，您通常会发现一个 submit 按钮，它会接收表单中的字段，并将其发送给一个 API 类型的服务。

字段和提交按钮的验证最好用单元测试来测试，以检查函数是否正确地处理数据并按照预期做出响应。开发人员将根据设计规范创建模拟值来执行测试。

例如，如果 API 的名字有 25 个字符的限制，开发人员将选择一个短名字来遵守字符限制，这不考虑无效输入。这就是组件测试有用的地方。

由于组件测试是封闭盒测试的一种形式，测试人员不知道设计限制。因此，他们会基于用户可能做的事情和假设场景创建一个用例列表，比如输入一个短名字、一个长名字，或者如果没有输入名字。组件测试填补了单元测试没有覆盖的空白，确保了一个全面且经过测试的系统。测试代码越多，测试代码的场景越多，应用程序就越好。

## 如何使用 CI/CD 进行自动化测试

一旦创建了所有的单元测试，就可以将用例写成代码了。之后，您可以实现一个 [CI/CD 管道](https://circleci.com/blog/what-is-a-ci-cd-pipeline/)来自动化测试过程。这意味着每次提交到存储库的一个分支时，管道将自动构建这个分支并运行您创建的测试。

自动化测试[在软件交付过程](https://circleci.com/case-studies/netguru/)中释放了大量时间——尤其是当代码库和系统变得更加庞大的时候。这也让提交代码变更时感到安心。开发人员将立即知道他们实现的更改是否对他们的代码产生了负面影响。如果提交的变更意外地影响了系统的不同部分，那么对测试的检查和验证将会失败。

## 结论

在本文中，您了解了单元测试和组件测试之间的区别，以及自动化测试套件的好处。每一次提交，你都会确信你的系统的每一个方面都处于工作状态。如果有些东西不符合您的测试要求，您将会立即知道，而不是等到用户报告问题时。测试软件的好处远远超过创建和维护测试所需的时间——尤其是当它们是自动化的时候。

实现一个有效的测试计划可能需要一些时间，并且自动化测试过程可能是复杂的。CircleCI 可以帮助自动化您的 CI/CD 管道，以加速您团队的交付并增强您对代码的信心。首先，[立即注册一个免费帐户](https://circleci.com/product/)。