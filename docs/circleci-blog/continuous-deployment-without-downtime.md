# 零停机部署| CircleCI

> 原文：<https://circleci.com/blog/continuous-deployment-without-downtime/>

随着工程团队越来越多地采用 DevOps 作为他们的软件开发策略，他们变得更快、更高效。不幸的是，这种速度和效率可能会暴露交付系统中的裂缝以及生产力的其他瓶颈。通常，您可以找到关于如何采用 DevOps 实践的信息，如[持续集成](https://circleci.com/continuous-integration/) (CI)和持续部署，但没有太多关于什么可能出错以及如何应对这些挑战的信息。

首先，让我们注意到[连续交付不同于连续部署](https://circleci.com/continuous-integration/#what-is-the-difference-between-continuous-integration-continuous-delivery-and-continuous-deployment)。虽然您可能会看到这些术语可以互换使用，但它们的含义是不同的。连续交付意味着主代码库总是处于准备部署的状态。尽管如此，这并不意味着有一个实际的交付或释放。将代码部署到生产环境需要一个手动步骤。

另一方面，连续部署涉及到自动化部署所需的所有步骤。它是软件开发自动化过程的最后阶段。使用连续部署，所有通过自动化 CI 测试的提交都被部署到实际的生产环境中。这既需要 CI，也需要持续交付。

## 为什么持续部署很重要？

传统上，软件开发团队主要关心他们的发布时间表。当有为新特性开发的代码或者现有的代码需要修复时，所有的改变都会被添加到一个大的版本中。将为更新设置一个具体的时间，并且在部署版本时通常会出现停机时间。随着现代软件开发实践的发展，现在有可能频繁地自动发布和更新。持续部署有几个好处:

*   工程团队可以针对市场变化立即采取行动。他们不再需要等待一个主要的发布来推动他们的代码库的变化。
*   您可以自动化从提交到部署的整个开发过程。这意味着系统管理员不必亲自执行发布，从而腾出时间来处理其他任务。
*   随着发布日期的临近，工程师们不再紧张。这使得他们可以专注于特性驱动的开发和测试。
*   它允许真实世界的实验。内部和外部客户可以成为 QA 流程的一部分，您可以获得即时的用户反馈，并能够在生产环境中执行 A/B 测试。

结果是，管理层将能够看到持续的进展，用户将在准备就绪后立即获得功能和补丁。然而，连续部署的成功取决于各种因素，包括测试套件的质量、部署策略和连续部署最佳实践的采用。

## 与持续部署相关的问题

虽然连续部署可以带来上述好处，但它也暴露了一些问题，如果没有解决方案，这些问题会影响部署的成功。这些问题包括:

*   对管道缺乏信心。开发人员和管理人员可能对自动化部署缺乏信心，担心他们会推出质量差的代码。这是由于两个主要原因:
    *   对测试套件缺乏信心。连续部署的一个基本组成部分是自动化测试。测试带来的挑战包括易变的测试、测试时间的增加和不完整的测试覆盖。
    *   对安全检查缺乏信心，没有从流程一开始就考虑安全因素。
*   使用外部资源和 OSS 有助于减少开发时间。但是，使用这些资源需要监控它们的状态和安全问题。
*   工具的可用性、兼容性和配置。为测试、安全和自动化寻找合适的工具组合是一项挑战。
*   在一个大型组织中处理多个团队是困难的，同步成为一个大问题。例如，产品团队和营销团队需要尽早调整，以消除延迟部署的最后一分钟的修订。
*   根据您的部署策略，需要额外的基础架构会导致额外的成本。

那么，您如何确保您的团队能够实现零停机部署呢？

## 处理零停机的障碍

以下是一些减少或消除上述问题的建议:

*   采用测试驱动的开发实践，为你的项目提供[详尽的测试覆盖](https://circleci.com/blog/path-to-production-how-and-where-to-segregate-test-environments/)。
*   尽早并经常与安全团队协调。
*   添加对您的操作系统和第三方服务的安全扫描。
*   使用一流的工具，实现灵活性、兼容性和功能性。
*   为所有相关方创建一个可见的开发时间表，并要求严格遵守。
*   使用微服务开发架构。这种架构是向后兼容的，它隔离了变化，并且允许每个服务内部的可测试性。
*   在对基础设施进行更改和添加之前，研究项目的最佳部署策略。

## 其他连续部署最佳实践

为了进一步增强零停机部署，应采用以下最佳实践:

*   将您的[基础设施视为代码](https://circleci.com/blog/an-intro-to-infrastructure-as-code/)。对基础设施中的变更使用版本控制和测试，就像对代码中的变更一样。
*   建立一个可以向相关团队成员发送警报的沟通渠道。
*   对于每一项任务，无论是功能需求还是缺陷修复，都要使用问题跟踪器。
*   使用包含问题编号的分支命名约定。
*   永远不要直接提交给主分支。
*   将高可用性构建到您的基础架构中，以提供冗余和弹性系统。

## 包扎

当充分考虑到与持续部署相关的挑战时，这是一个提供持续改进的解决方案。快速响应市场变化，从提交到部署的整个流程实现自动化，减轻工程师的压力，并在真实环境中进行试验，可以更频繁地为您的用户提供更多价值。

* * *

Alice Njenga 喜欢将密集的技术材料转换成对外行和技术专业人员都容易理解的文章。

[阅读 Alice Njenga 的更多帖子](/blog/author/alice-njenga/)