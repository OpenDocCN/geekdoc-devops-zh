# 反馈循环:改善平均恢复时间的关键

> 原文：<https://circleci.com/blog/feedback-loops-the-key-to-improving-mean-time-to-recovery/>

红色构建是 DevOps 团队生活中的一个事实:如果你用自动化工具开发测试良好的软件，你的一些构建将不可避免地失败。但是从失败的构建中缓慢的恢复时间不应该被认为是理所当然的，因为它们损害了团队加速开发周期的能力。为了缩短平均恢复时间(MTTR)，开发人员需要数据来解决问题。[持续集成](https://circleci.com/continuous-integration/)和持续交付(CI/CD)通过快速提供关于您的构建的数据，创建开发运维团队所需的快速反馈循环，有助于缩短恢复服务所需的时间。

我们很快会说，速度从来不是健壮的 DevOps 实践的唯一目标。正如我们在最近的报告[中所解释的那样，CI 的数据驱动案例:实践中 3000 万个工作流揭示了关于 DevOps 的什么](https://circleci.com/resources/data-driven-ci/)，像 MTTR 这样的指标需要与其他质量指标(如交付时间和部署频率)一起理解；还有，速度需要和质量相匹配。CI/CD 有助于加速开发，同时还为开发运维流程增加了智能和洞察力。交付的一致性是自动化的无名英雄:没有可靠、一致质量的速度是没有帮助的。

本文是系列文章的第三篇，我们将探讨 CircleCI 工作流中的数据如何支持 MTTR 等行业标准指标。这些指标表明，在不牺牲速度的情况下优化稳定性是可能的，CircleCI 的数据显示了团队在现实生活中如何根据这些指标进行操作。

## 在更短的时间内将构件从红色变为绿色

缩短平均恢复时间要求您快速获得可操作的信息。如果您的团队可以快速返回失败状态，他们可以在最短的时间内将构建从红色变为绿色。采用 CI/CD 实践能够实现快速反馈循环，并且是确保开发人员快速获得信号的最佳方式。通过强大的 CI/CD 实践，开发人员可以从您的测试套件中访问实时工件，例如日志和覆盖率报告，这使开发人员有机会在与生产环境相当的环境中进行故障排除。

为了了解观察到的开发行为如何与行业标准进行比较，我们查看了 2019 年 6 月 1 日至 8 月 30 日期间观察到的超过 3000 万个工作流的 CircleCI 数据。工作流代表:

*   每天运行 160 万个作业
*   超过 40，000 个组织
*   超过 150，000 个项目

以下是我们的发现:

*   记录的最短恢复时间不到一秒。
*   最长时间为 30 天。
*   平均恢复时间为 17.5 小时。

只有当两个工作流几乎同时启动，并且一个失败而另一个通过时，最短恢复时间少于一秒的情况才会发生。在任何其他情况下，都不可能在那么长的时间内收到信号并做出响应。

对于 30 天的最大记录 MTTR，这是 CircleCI 的数据集在 30 天标记处截止恢复的一个函数，并不意味着在 30 天内会发生恢复。

这里有趣的数据不是最短时间或最长时间，而是恢复的中值时间，即 17.5 小时——大约是一个工作日结束和另一个工作日开始之间的时间长度。这意味着当工程师在一天结束时收到一个失败的信号，他们会等到第二天来解决它，并可能提供对 DevOps 团队如何运作的洞察。

## 从我们的数据中有什么收获？

17.5 小时的中值与民意测验和调查反映的传统观点相反，民意测验和调查表明 MTTR 要快得多。是什么导致了报告行为和观察行为之间的差异？我们猜测，调查设计本身正在影响一个快速报道的 MTTR。

关于[工程指标](https://circleci.com/blog/engineering-metrics/)的调查问题通常是这样措辞的:“对于您工作的主要应用程序或服务，请告诉我 _____？”然而，CircleCI 的数据涵盖了所有分支的所有工作流，而不仅仅是默认分支，也不仅仅是主应用程序。虽然观察到的中值恢复时间为 17.5 小时，但主应用程序默认分支的平均恢复时间可能更快，更像是几分钟而不是几小时。

根据我们的工作流数据，在 90 天的观察时间内，超过 30%的活动项目分支从未失败过(即，100%绿色)——这意味着 MTTR 为 0 秒。因为他们从来没有失败过，所以他们从来不需要恢复。

我们工作流中其他有趣的数据点显示，50%的恢复发生在不到一小时的时间内，25%的组织在不到 15 分钟的时间内恢复。我们还注意到，50%的组织在一次尝试中恢复，75%的组织在两次尝试中恢复。

表现最好的 10%的人花了不到 10 分钟的时间做必要的工作来修复他们的构建并回到绿色。这支持了 DevOps 2019 报告的[状态中发现的精英执行者的恢复时间指标。报告指出，精英团队的平均恢复时间不到 1 小时，而表现不佳的团队恢复时间在一周到一个月之间。](http://cloud.google.com/devops/state-of-devops/)

有趣的是，在三个小时和 17.5 小时的中间时间之间的数据有很大的频率差距，这表明如果红色构建没有在三个小时内恢复，它很可能要到第二天才能修复。

## 每一点 CI 都有帮助

改善 MTTR 是成为高绩效 DevOps 组织的一步。而且，正如我们在 CircleCI 坚信的那样，即使是一点点也有助于提高性能。即使你刚刚开始 CI/CD，并且做得不完美，你仍然在正确的轨道上。

在这个四部分系列的下一篇也是最后一篇文章中，我们将关注[变更失败率](https://circleci.com/blog/what-does-the-change-fail-rate-tell-us-about-high-performing-teams/)。如果你错过了前两篇文章，请阅读关于[交付周期](https://circleci.com/blog/continuous-integrations-impact-on-lead-time/)和[部署频率](https://circleci.com/blog/why-continuous-integration-is-key-to-stepping-up-deployment-frequency/)的文章。