# 我的管道容易受到攻击吗？圆环

> 原文：<https://circleci.com/blog/is-my-pipeline-vulnerable/>

您的[持续集成(CI)管道](https://circleci.com/blog/what-is-a-ci-cd-pipeline/)是您的应用程序的变更管理过程的核心。正确设置后，CI 管道可以自动执行许多手动任务，以确保您的应用程序及其运行环境的一致性和可重复性。如果您使用这个管道来扫描应用程序、容器和基础设施配置的漏洞，那么它可以成为您的安全策略的一个组成部分。

然而，**管道本身可能包含潜在危害您所有系统的漏洞**。幸运的是，通过对设计“文化”的一点关注和改变，您可以发现并减轻 CI 管道安全问题。

在本文中，我们将讨论一种与技术无关的方法来发现和缓解这些管道漏洞，以及确保从设计到部署等各个阶段的安全特性的方法。

## 发现漏洞

当您查看完整的 CI 管道时，通常会看到几个组件协同工作，为您的应用程序提供高效的集成和部署流程。这些组件需要相互信任，通过流程步骤传递正确的信息，以确保每次都能快速、一致地获得预期的结果。因为管道组件具有不同的依赖性和要求，所以可能存在攻击者可以利用的问题。

幸运的是，**大多数漏洞都与您的管道**的配置或管理有关。您的管道中可能存在的一些最常见的安全问题或风险包括:

*   共享、开放或受损的源代码库
*   构建服务器和容器配置错误
*   缺少对操作系统、运行时和工具的更新
*   代码库中公开的秘密、密钥和凭证
*   缺乏监控工具或定期维护
*   组件的访问控制和安全设置管理不善

## 解决漏洞

漏洞列表中的大多数问题也存在于您构建的应用程序中，因此查找和解决这些漏洞应该有些熟悉。就像应用程序一样，您必须研究和评估管道的攻击面，以提出一套保护管道的最佳实践。

使用上面的列表作为起点，以下步骤将有助于最小化与这些安全问题相关的风险:

*   **锁定你的源代码库**。尽量减少有权批准与您的管道直接相关的拉请求的人数，并使用严格的代码审查周期。
*   **将[基础设施作为代码(IaC)](https://circleci.com/blog/an-intro-to-infrastructure-as-code/) 实践**用于您的构建服务器，并且在可能的情况下，尝试采用关注内置安全性的短命容器。
*   **定期审计和更新管道中的操作系统、运行时和构建工具**。定期安排安全补丁和错误修复有助于减少用于构建应用程序的库中的错误和缺陷。
*   **从代码中移除秘密、凭证和密钥，并采用秘密管理器**，例如 [SecretHub](https://secrethub.io/) 、 [Fortanix](https://fortanix.com/) 或 [AWS 系统管理器参数存储](https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html)。
*   **采用审计工具**,让你能够跟踪对你的管道所做的改变。使用代码分析工具来扫描代码中常见的漏洞，以确保在源代码中纠正这些漏洞。
*   **在整个管道中实施访问控制和安全策略**,以阻止未经授权或匿名的访问。

## 什么是 DevSecOps？

我所描述的补救措施依赖于采用一种开发人员心态。DevSecOps 是一组额外的实践，旨在通过“左移”将更常见的 DevOps 流程中的安全问题转移到更接近开发的地方

总体思路是**大部分安全问题和风险可以在设计和开发过程中解决**。在这些早期阶段，开发人员可以从一开始就对安全性进行规划和自动化，而不是依赖于部署后的安全性测试。正是这种文化上的转变，即参与软件交付的每个人都考虑应用程序的安全性，使得安全的应用程序开发得以快速进行。

你能做些什么来开始将你的 DevOps 实践扩展成 DevSecOps 实践？

您不一定需要添加昂贵的专业工具来开始这种实践。一些常见的策略是:

*   鼓励所有利益相关者开始了解应用程序开发中的现代安全威胁。
*   为开发周期中的不同利益相关者开发流程，以应对各种安全事件。
*   利用您现有的 DevOps 沟通渠道，允许人们快速分享安全问题和风险，以加快解决问题。作为正常软件交付过程的一部分，在整个开发生命周期中实施定期的安全性和合规性审计。
*   采用适当的安全工具，这些工具可以帮助您实施安全和遵从性策略，并且可以检查您的代码和管道中的安全漏洞。

## 代码漏洞

**DevSecOps 理念的核心组成部分包括定期在编写时或在源代码中设计和测试安全代码**。这个过程被称为静态应用程序安全测试(SAST)。有许多工具可以帮助自动化 SAST。

SAST 是对应用程序内部结构的一种测试形式，通常针对类似于在 [OWASP 十大](https://owasp.org/www-project-top-ten/)中发现的漏洞类型。像 [Snyk](https://snyk.io/) 、 [WhiteSource](https://www.whitesourcesoftware.com/) 和 [NowSecure](https://www.nowsecure.com/) 这样的工具可以作为拉取请求的一部分或在开发过程中针对您的代码库运行，在安全问题进入您的管道之前就将其捕获。

更传统的动态应用程序安全测试(DAST)是一种在执行过程中针对应用程序运行的测试形式，没有应用程序内部结构的详细信息，以发现攻击者可以利用的漏洞。

理想情况下，你应该在你的开发生命周期中同时使用静态和动态应用安全工具。虽然静态测试不会像动态测试那样发现与基于环境的安全问题相关的漏洞，但它会在安全问题变得更加昂贵之前及早发现它们。结合这两种形式的测试，并将其自动化到您的管道中，将提供全面的漏洞扫描分层。

添加 SAST 工具成为长期“安全左移”思维模式的关键部分，在开发人员编码时或合并之前，会给他们带来安全问题和风险。这有助于开发人员更加意识到常见的安全问题，并允许他们养成编写代码的良好习惯，在第一次尝试时就通过安全检查。

采用 SAST 工具并将结果合并到代码审查中，允许开发人员快速上手，同时仍然在 QA 和生产中使用 DAST 工具来实现更严格的安全测试。

## 后续步骤

您的应用程序的消费者值得并期望它是高性能的、可用的和安全的，特别是如果您存储他们的数据，或者他们依赖它进行日常操作。通过保护构建应用程序的管道并最大限度地降低管道受损的风险，您可以提高部署的速度和可靠性。

将“左倾”的安全态度作为一种实践，并在开发过程中采用安全工具，可以消除与应用程序相关的许多安全风险。这种结合的方法允许您利用 DevOps 的自动化和可重复性原则。

首先，确保您的 CI 渠道得到保护和维护。如果你还没有做 DevSecOps，为什么不试一试呢？CircleCI 提供了大量的[安全集成](https://circleci.com/integrations/security/)来对抗我们已经讨论过的漏洞，并且不需要花费任何成本就可以开始使用。