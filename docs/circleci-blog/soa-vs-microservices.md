# SOA 与微服务:超越整体

> 原文：<https://circleci.com/blog/soa-vs-microservices/>

现代软件开发越来越依赖于[分布式](https://circleci.com/blog/distributed-systems/)、基于服务的架构模式来实现可伸缩性、可靠性以及快速构建、测试和发布周期。两种最流行的基于服务的方法是**面向服务的架构(SOA)** 和**微服务**。在本文中，我们将研究这两种方法，以确定它们的相似之处和不同之处，以及每种方法的一些用例。

由于 SOA 是公认的较老的风格，它可能不适合现代的云原生应用程序。但是它仍然提供了许多好处，使它成为许多不同场景中的最佳选择。通过了解 SOA 的哪些方面仍然相关，哪些部分已经被微服务所取代，您将能够在这两者之间做出选择，用于下一个基于服务的应用程序。

让我们先来感受一下 SOA 到底是什么。

## 什么是面向服务的架构？

全球研究和咨询公司 Gartner 最初在 20 世纪 90 年代中期创造了术语“面向服务的架构”。结构化信息标准促进组织(OASIS)——IT 行业标准委员会——[将 SOA](https://www.oasis-open.org/committees/download.php/19679/soa-rm-cs.pdf) 定义为“一种组织和利用分布式功能的范例，这些功能可能处于不同所有权域的控制之下。”

SOA 是一种构建可以在开发中伸缩的后端的方法——换句话说，是一种可以快速增加新开发人员和附加功能的方法。请注意，SOA 是一种架构风格，而不是特定的实现。在这种架构风格中，一切都以服务为中心(因此得名)。这里，**服务**是业务领域的功能表示。

通常，服务通过[服务总线](https://en.wikipedia.org/wiki/Enterprise_service_bus)进行通信，服务存储库识别它们。因此，服务以松散耦合的方式集成，只能在线使用。契约必须确定一个通信 API。这个契约建立了一个特定的接口来触发业务逻辑或访问数据。因此，它使用一些标准化的消息传递协议，这些协议通常比简单的 REST 要复杂得多。

因为通信是通过服务总线进行的，所以它会在需要时定位接收者——或者不需要。理论上，这允许请求排队和异步工作负载执行。但是这里大多数协议都是同步的，这意味着即使是异步工作负载也需要立即响应。

每个服务都应该足够隔离，以便有人可以独立开发它。然而，由于 SOA 完全是关于重用的，任何服务都可能共享或重用甚至是基本的组件，比如数据存储。服务没有框架或编程语言要求。这样，平台访问和开发普遍成为可能。

## 什么是微服务？

微服务架构是后端系统的另一种方法。UNIX 操作系统范式——“做一件事，并把它做好”——指导着这个体系结构。

事实上，微服务都是关于模块化和解耦后端能力的。小型开发团队创建并发布较小的实体，而不是创建一个大型服务。

虽然网飞在 2000 年代后期推广了微服务方法，但许多其他人在此之前已经尝试过这种模式。事实上，它的起源可以追溯到 2004 年，并且与 SOA 有很强的相似性。这可能就是开发人员最初将微服务方法描述为“细粒度 SOA”的原因

它对 DevOps 的严重依赖使微服务脱颖而出。在理想的微服务实现中，事实的全部来源在于代码——从开发到部署，再到运行时编排。因此，任何微服务都应该尽可能独立，提供自己的数据存储和通信协议。它还应该尽可能的轻便；DevOps 倾向于使用 REST 的简单 HTTP。

虽然微服务的目标是轻量级的，但它们仍然很复杂，并且需要大量资源。给每个团队他们自己的服务世界会导致重复和编排开销。结果，复杂性从构建一个大型应用程序的协调转移到这些小规模服务的编排。

虽然 DevOps 工程师仍然在激烈地讨论正确的微服务规模，但我们总是可以回到从根本上代表业务(子)领域的 SOA 定义。然而，虽然 SOA 最大化了重用，但是微服务试图清理有界的上下文，这最终导致了(想要的)重复。

## 基于服务和微服务架构解决了哪些问题？

尽管从外表上看非常相似，但 SOA 和微服务在许多方面都有所不同。根本的区别在于共享的代码和责任。虽然 SOA 试图将共享组件带到相互服务中并尽可能多地重用，但微服务方法尽可能少地共享。

一个完整的微服务可能有自己的日志系统、认证处理和其他纯技术功能。同时，SOA 肯定会将这些公共方面放到一个专用的服务中，以便尽可能地共享。

SOA 解决了大型企业应用程序中的一个常见问题，即公司需要将一组现有的应用程序(或服务)置于一个保护伞之下。他们经常使用诸如“企业服务总线”或“服务存储库模式”这样的词语 SOA 包含服务存储库和服务总线等元素并不奇怪。

另一方面，微服务方法是为云原生时代开发的，在这个时代，单个服务在内部和外部都是公开的。这种设置通常将第三方服务、编排平台和定制服务全部组合在云中。

微服务提供的 API 指导和规范不如 SOA 正式。如前所述，DevOps 团队通常使用 HTTP 和 RESTful 原则实现微服务 API，但这绝不是一成不变的。此外，微服务不需要 API 网关之类的组件——理想情况下，根本不使用 API 网关。SOA 范式需要一个中央服务来访问各个服务。

除了共享，我们发现这两种方法对服务实体的解释也不同。服务对于在微服务上下文中构建单个应用程序至关重要，而 SOA 使用服务来集成多个应用程序。

## SOA 与微服务:您应该使用哪种方法？

如今，看到新的 SOA 项目相对来说并不常见。原因很简单:约束太多，知识太少。大多数开发人员要么更熟悉微服务方法，要么更喜欢它提供的一些自由。

所以，问题是，什么时候应该使用 SOA？如果您正在构建一个应该(并将永远)作为一个整体工作的平台，但需要强大的功能伸缩性并遵循预定义的业务领域，SOA 是一个很好的选择。基于这些考虑，SOA 是包含许多不同应用程序和服务的大规模企业平台的理想候选。

如果你追求独立的服务，那么微服务方法是更好的选择。这种方法将几乎所有特定的选择都留给了服务。通过这种方式，每个团队可以完全自治，并拥有从编码到部署和运行时行为的完全控制权。

SOA 诞生于经典的企业运营，这并不奇怪。即使在今天，SOA 仍然提供了更大的后端平台所需的许多方面。该架构处理数据一致性和治理，使公司能够完全集中控制平台。相比之下，一个真正的微服务平台有很多个人所有者，它无法从单个地方进行控制。

## 结论

如果您曾经构建过基于微服务的后端，那么您可能已经遇到了一些 SOA 可以为您解决的挑战。另一方面，SOA 也有自己的复杂性和限制。毕竟，人们如此迅速地加入微服务潮流是有原因的。

了解 SOA 和微服务之间的区别是为给定问题选择正确架构的关键。尽管 monoliths 在许多方面仍有其一席之地，但不要忽视 SOA 的分布式开发方面以及微服务等衍生架构模式。

问题本身应该决定你选择哪种方法，而不是当前的趋势。选择适合给定情况和可用资源的架构模式，您的项目将步入正轨。