# 为工作选择正确的(构建)工具| CircleCI

> 原文：<https://circleci.com/blog/choosing-the-right-build-tool-for-the-job/>

除了选择编程语言、编辑器、CI/CD 和 VCS，选择构建工具是我们作为开发人员可以做出的最重要和最有影响力的决定之一。每次测试或编译应用程序时，或者捆绑应用程序以部署到生产环境时，都会用到它。

考虑到构建工具的重要性，选择它可能是一项艰巨的任务，在这篇文章中，我将试着让它变得简单一些。

我将介绍几件事情:

*   构建工具的作用和一些工具的例子
*   为什么您可能想要考虑构建工具——无论是从零开始一个项目，还是当您正在迁移一个现有的项目时
*   您应该如何测试任何构建工具，以确保它是最适合您、您的团队和您的项目的

**注意:** *这篇文章假设你需要一个商业项目的构建工具(为你赚钱的工具)。一个爱好或教育项目会有不同的需求，这些需求会影响您对工具的选择。既然如此，你做你的，做你想做的。*

**剧透提示:**我有偏见，我相信默认的、最广泛应用于你的平台的工具很可能也是最适合你的。

## 什么是构建工具？

构建工具将许多实用程序和脚本结合在一起，用于编译、打包、测试、运行和发布应用程序。通常他们会让你进行依赖管理。有些允许你编写更多的步骤和插件，比如代码覆盖率和安全扫描。您的构建工具充当与 CI/CD 系统的单点联系，取代了必须手动运行的各个工具。

## 构建工具的示例

一些流行的构建工具包括 NPM 和 Yarn - for Node、Gradle 和 Maven。Ant 是 Java 的构建工具，Rake 是 Ruby 的构建工具，Make 是 Unix 和 Linux 系统的构建工具。一个特定的工具可能与他们使用的平台和编程语言相关联，比如用于 JVM 的 Gradle 和用于基于 Ruby 的项目的 Rake。这意味着它们为处理各自的平台带来了有用的抽象。有些还被设计成语言不可知的，如 Make 或 Bazel，这使得它们可以被在多种平台和语言上开发的组织使用。

工具的制造者和维护者也各不相同。Make 和 Rake 是“适当的”开源项目，仅由社区提供支持。NPM 和格雷迪得到了他们各自盈利组织的支持，这些组织对企业功能、支持或服务收费。像 Bazel 和 Buck 这样的工具是由大型科技公司(分别是谷歌和脸书)作为内部工具开发的，他们决定作为开源项目发布，而不从中赚钱。

## 为什么选择构建工具？

既然我们已经介绍了构建工具领域的一些例子，我们可以看看您选择工具的可能原因。

### 如果你是从零开始一个项目

选择构建工具的第一个原因是从头开始一个项目。如果你不想手动调用所有低级命令，你需要一个构建工具。手工努力不可避免地以一组未经测试的、半生不熟的 bash 脚本告终，这是一个糟糕的想法。

我建议您使用默认工具，无论您的编辑器、项目生成器或模板使用什么工具。例如，对于 Android 项目，缺省值是 Gradle。或者，您可以使用通用工具，如 Buck 或 Bazel，或者不同的 JVM 专用工具，如 Maven。

### 如果您正在迁移现有项目

第二个原因是，有时默认的构建工具并不适合您。这可能是因为您正面临着性能问题:构建缓慢或内存不足。有时构建是易变的和不确定的，导致您花费大量时间调整构建脚本和配置项配置，试图修复构建。

在这种情况下，换一种不同的工具，也许是一种在博客帖子和会议讨论中被誉为速度极快并被大型科技巨头接受的工具，可能是令人信服的。我过去也是这么做的。

## 挑选构建工具的步骤

我建议您通过一系列测试来使用这个构建工具，看看它如何为您的项目工作。这些测试从简单到复杂，后面的阶段可能会花费你几天甚至几周的时间。同样，选择构建工具是一个重大的决定，所以要小心行事。花些时间记录每个测试的整个过程和结果。

选择一个构建工具不应该是一个人的努力，所以要确保你的团队成员尽早并且经常参与进来。任何新工具或流程要取得成功，都需要他们的认可。构建工具也不例外。

### 从问题陈述开始

考虑你在构建工具中寻找什么。选择工具有许多合理的理由，但是“我们应该采用它，因为 BigCo Inc .使用它”不是其中之一。该测试可能需要几个小时才能完成，通常更短。

以下是一些好的问题陈述的想法:

*   **开发人员生产力**既适用于现有团队成员和新入职员工，也适用于您内部团队和部门的生产力。

*   **构建的性能**在将现有项目迁移到新的构建工具时尤为重要，因为构建的性能会降低。有时这是一个合理的担忧，但其他时候这可以通过调整和优化现有工具的使用来弥补。例如，[优化您的 CI/CD 构建配置](https://circleci.com/blog/six-optimization-tips-for-your-config/)也可以提高性能。

*   整个组织的统一意味着建立一个公共的构建基础设施团队，并配备专家来维护和调整整个组织的构建工具和基础设施。为了使这种策略有效，您的组织应该足够大，以维持一个基础结构团队。在这种情况下，将一些工作交给这个团队是有意义的。参见:[如何成为一名 CI/CD 工程师](https://circleci.com/blog/how-to-be-a-cicd-engineer/)。

如果您努力提高开发人员的生产力，并且其他两个问题都不是问题，那么您的团队使用默认选项可能会得到最好的服务。虽然每个 Android 开发人员都知道如何使用 Gradle，但很少有人会精通 Buck 或 Make。

### 评估文档

一旦您知道了选择构建工具的主要动机，您就可以开始考虑第二个因素了——评估文档和其他学习材料。这应该比定义您的问题陈述花费更长的时间，但是您不应该在每个构建工具上花费超过一天的时间。

您在文档中寻找的内容可能会有所不同，但您最终可能会问以下一些问题:

*   创建该工具时的动机和设计考虑是什么？这可能是 docs 的一部分，也可能是一篇独立的博客文章，但是能够进入作者的大脑，了解他们最初为什么想要创建这个工具是非常好的。也许它特别适合在 monorepo 中构建微服务，而这正是您所需要的。

*   文件是否完整？检查文档的各个页面，看看你是否找到任何仍然保留的重要文档，比如*如何测试你的应用*部分。这取决于你对风险的容忍度，但是不完整的文档可能意味着工具还没有准备好。

*   **跨各种渠道的支持是怎样的？**文献不仅仅是`docs/`。这个社区大吗，活跃吗，乐于助人吗，支持吗？是否有行为准则和版主来维护？检查 GitHub 上公开和关闭的问题，StackOverflow 上该工具的受欢迎程度，以及您可能使用的任何其他渠道，如 Slack teams 或 Discord 服务器。如果缺少文档，一个有用的社区肯定是必要的。

*   代码看起来怎么样？检查重要文件中是否有遗漏的注释。工具[是否集成了 CI/CD 服务](https://app.circleci.com/pipelines/github/facebook/react-native)？主枝是否通过？最新版本是什么时候？不同的用例有很多例子吗？

如果该工具满足或超出了您对所有这些因素的预期，请继续。否则，使用默认设置。

### 评估一个示例项目

现在是时候看看他们的一些样本或教程了，看看他们感觉如何。克隆一个示例项目(或者更好的是，按照一步一步的教程)，并探索它。如果你想彻底做到这一点，一个工具很容易就能花上一天的时间。

在本地构建项目，然后运行测试、更改步骤、添加依赖项、编写附加脚本，并与您的团队使用的第三方服务集成。添加您认为您的真实项目将需要的任何内容。

该工具的行为如何？一切都如你所愿吗？示例项目是否适合您的平台和语言选择，或者您是否必须从头开始创建它？

此时，您应该已经用您的 CI/CD 工具建立了示例项目，并确保它能够很好地构建和运行测试。您的默认构建工具可能是开箱即用的，但对于不太流行的工具，您可能需要将它安装在您的构建机器上。安装时间和难度会有所不同。检查安装和设置需要多长时间。这个过程顺利吗，或者你遇到了什么小故障吗？

一旦您在 CI 平台上构建了最小的示例项目，您还可以返回并跨您正在评估的多个构建工具重新实现相同的示例应用程序。如果您正在寻找速度和性能的改进，您的 CI 平台应该为您提供一种简单的方法来测试和比较结果。

前面的步骤简单易行吗？在构建或测试它时，您是否经历了巨大的努力？你遇到文档问题了吗？与下一步考虑相比，这些问题中的任何一个都可能只是冰山一角。

### 迁移到真实项目(或者尽可能接近真实项目)

如果你仍然快乐，仍然试图做出决定，是时候迈出一步，真正使用这个工具了。如果您正在迁移一个现有的项目，您知道您需要构建什么。如果您不是，并且正在研究一个从零开始构建的项目，请扩展示例以包含您可能需要的所有内容。

您将在此执行的检查与示例项目的上一步类似，但是具有使用真实场景评估工具的优势。最重要的是要注意这个练习的时间。花几天，一周——无论你需要多长时间。咨询团队，并像在 sprint 计划中一样添加一些内容。

在本练习结束时，您应该准备好做出决定，并让团队相信您选择的构建工具是正确的选择。

### 获得团队成员的同意

团队对开发人员工具的认可就是一切；有了像构建工具这样有影响力的东西，就更是如此了。与您的团队交流，并向他们展示您的测试结果。确保他们知道该工具的与众不同之处，以及使其成为团队正确选择的复杂性和细节。

学会如何使用这个工具花了多长时间？用这个时间乘以你团队的人数。这足以说服你的经理和利益相关者吗？如果你对自己的选择有信心，并有数据证明，你应该处于有利位置。向前去建造吧！

## 结论

开发人员的构建工具是与编程语言和框架同样重要的选择。知道并理解你为什么选择某样东西会对你和你的团队的生产力有很大的影响。我有意谨慎地提供了这些考虑因素。他们喜欢现状和你平台的默认选项。根据我的经验，作为一名成功的开发人员，良好的社区支持、文档和示例项目是你真正需要的。一个好的构建工具也会帮助你、你的团队和你的产品取得成功。