# 如何成为一名 CI/CD 工程师| CircleCI

> 原文：<https://circleci.com/blog/how-to-be-a-cicd-engineer/>

去年，我在[什么是 CI/CD 工程师](https://circleci.com/blog/cicd-engineer/)中写下了我对 DevOps 生态系统中一个角色的想法。在那篇文章中，我分享了为什么这个角色应该存在的理由，以及我对 CI/CD 工程师应该具备的特征、职责和技能的一些初步想法。

自从最初的版本发布以来，我已经与开发人员和 DevOps 专业人员就我对这个角色的看法进行了许多引人入胜的讨论。这些互动和对话给我提供了大量的反馈。我很高兴地得知，它与我交谈过的大多数人产生了共鸣。

在这篇文章中，我将提炼一些想法，并分享一些过去一年的额外收获。

## 什么是 CI/CD 工程师？

在我们开始之前，我将简单分享一下我在[什么是 CI/CD 工程师？](https://circleci.com/blog/cicd-engineer/)这篇文章关注了这个角色的两个核心要素:特点和职责。

### CI/CD 工程师的特征

*   很强的沟通技巧
*   敏锐的分析技巧
*   能够将复杂的流程分解成可理解的组件
*   精通自动化和优化流程
*   能够胜任团队建设和团队沟通策略

### CI/CD 工程师的职责

*   制定 CI/CD 原则
*   反复审查和修改 CI/CD 原则
*   维护 CI/CD 工具/平台(如果适用)
*   开发和维护管道配置
*   自动化流程

这些要素仍然适用，经过深思熟虑和多次交谈，新的细节和模式已经出现，证实并支持我的一些想法。在这篇文章中，我将分享这些启示。

## 新兴的 CI/CD 工程模式

DevOps 和持续交付相关的概念和模式在业界越来越受欢迎。这些概念围绕着安全性、管道优化和整体的 [CI/CD](https://circleci.com/continuous-integration/) 健康。以下是我将讨论的与 CI/CD 工程师相关的新概念列表:

*   安全/开发部门
*   管道优化
*   性能基准

### CI/CD 工程师的安全/开发保障

在我最初的[帖子](https://circleci.com/blog/cicd-engineer/)中，我建议将与安全相关的职责作为 CI/CD 工程师角色的一部分。随着 [DevSecOps](https://en.wikipedia.org/wiki/DevOps#DevSecOps,_Shifting_Security_Left) 和开发人员友好工具的日益采用，安全责任和流程正在乞求“左移”。这实质上意味着开发人员能够自信地将与安全相关的活动合并到他们的 CI/CD 过程的初始阶段，因此将它们向左移动(朝向这些过程的开始)而不是向右移动(朝向结束)。

**CI/CD 工程师可以在安全团队和负责合规/监管要求的人员之间建立强大的沟通渠道。**这些沟通渠道在开发人员和安全团队之间产生了有价值的协作，使每个人都能很好地了解关键需求。这些协作还促进了 DevSecOps 原则的采用，使开发人员了解并投资于其他未知的安全实践。

我在下面确定了一些应该发生在 CI/CD 管道的“左边”或初始部分的安全实践。这些很可能由 CI/CD 工程师来定义。这些实践简化了所需的安全任务，并提供了宝贵的反馈循环，防止了在您继续处理最终以失败告终的下游管道段时出现的时间和资源浪费。最好在管道中尽早发现并解决问题。

以下是 CI/CD 工程师可以定义和维护的一些安全实践:

*   **漏洞扫描:**探测应用程序的安全弱点，这些弱点可能会使应用程序遭受攻击
*   **容器映像扫描:**分析容器映像的内容和构建过程，以检测安全问题、漏洞或有缺陷的做法
*   **法规/合规性扫描:**评估对特定合规性要求的遵守情况

还有许多其他的行业标准安全实践通常在发布过程中实现。我上面提到的例子只是 CI/CD 工程师可以与安全和 DevOps 团队合作实施和管理的一些任务，以确保所有安全和合规性要求都是自动化的，并在 [CI/CD 管道](https://circleci.com/blog/what-is-a-ci-cd-pipeline/)部分中得到一致应用。

### 面向 CI/CD 工程师的流水线优化

根据我的经验，CI/CD 管道是以一种*设置它并忘记它*的方式处理的。不管出于什么原因，**团队投入了大量的时间和精力来自动化他们的软件开发和发布过程，结果却在实现之后放弃了这些工作。**这主要是因为害怕打扰或破坏对发布软件至关重要的东西。

尽管这是一个潜在的现实，CI/CD 管道意味着代表软件开发和发布过程。因此，它们必须被持续地监控、评估和调整，以确保它们不仅准确地自动化您的软件开发和发布过程，而且高效地这样做。这些管道必须定期重新检查和调整，对于不熟悉所有管道部分的个人来说，这可能是一项艰巨的任务。

这就是 CI/CD 工程师的专业知识能够带来巨大价值的地方。我认为他们是 CI/CD 管道沙皇。他们可以确保管道不被忽视，并有效运行。下面是我的一些想法，让 CI/CD 工程师与适当的团队合作，通过适当地维护和优化管道来增加价值。

#### 管道可重用性

我经历过的并且经常与他人讨论的许多痛点都围绕着管理 CI/CD 工具中的管道配置。这些配置定义了管道，并作为 CI/CD 平台上自动化的执行代码。它们通常用 [YAML](https://circleci.com/blog/what-is-yaml-a-beginner-s-guide/) 、[领域特定语言(DSL)](https://en.wikipedia.org/wiki/Domain-specific_language) 或者其他一些类似的变体来表达。

这些配置中语法通常在功能上受到限制。尤其是在可重用性方面。这主要源于这样一个事实，即语法，像 YAML 一样，是一种声明性的数据结构，而不是一种编程语言。

配置语法导致的限制性代码重用是可以克服的，但需要额外的努力，例如构建可以表示管道段同时封装功能的执行脚本。这些配置可重用性问题在大多数 CI/CD 平台中是常见的，并且通常具有相同的影响:它们非常难以维护。

CircleCI 通过引入[配置参数](https://circleci.com/docs/pipeline-variables/#pipeline-parameters-in-configuration)和 [orbs](https://circleci.com/docs/jobs-steps/#orbs-overview) 识别并解决了这种配置可重用性，这是一种非常有价值的机制，允许用户轻松打包、维护和实现可重用的管道配置。

不管团队采用哪种配置重用策略，很明显，如果没有专门的维护人员，这些配置重用工作对团队来说会变得非常困难。我认为这是 CI/CD 工程师推动这些工作的绝佳机会。CI/CD 工程师可以对常见的模式和功能有很好的理解，这些模式和功能可以被捕获并封装到有用的动态执行代码中。

#### 大小合适的计算/资源节点

维持高速管道和有价值的反馈循环的一个方面是确保 CI/CD 构建在资源充足的计算节点上执行。在能力严重不足的构建资源上执行管道构建非常普遍，这直接导致了构建速度变慢和反馈循环变长。确定规模适当的计算节点的规格并不是一项简单的任务，这主要是因为要在硬件要求(如 CPU、RAM、网络、磁盘 IO 能力)和维持可接受的构建时间之间取得平衡。技术堆栈和服务之间的硬件需求差异很大，这些细节经常被团队忽略。根据我的经验，这可能是因为团队没有完全了解他们的技术堆栈，和/或他们假设增加的计算节点容量比实际更昂贵。

更强大的计算节点通常成本更高，但成本通常不像大多数团队担心的那样昂贵。我有过这样的经历:通过迁移到一个足够强大的计算节点，某些构建任务减少了一半以上。这个特定的构建作业在一个使用两个 CPU 内核和 4GB RAM 的资源类节点上需要五分钟才能完成。我把资源类升级到 4 个 CPU 核+ 16GB RAM，2.1 分钟完成构建，只多花了几分钱。

在这种情况下，资源类的成本确实增加了很小一部分，但是构建工作的总时间也大大减少了，当考虑到其他费用(如开发人员等待构建完成)时，这创造了更大的节约。通过减少构建时间，开发人员可以更快地获得反馈，并可以在冲刺阶段转移到其他任务上。

CI/CD 工程师可以帮助团队确保构建在资源充足的计算节点上执行。与开发人员和运营商共同承担的许多职责一样，这些看似无关紧要的细节没有得到监控或解决，直到尺寸不足的节点的影响变得非常明显。让一个角色监控和调整这些计算节点问题可以为团队节省大量时间和金钱，同时还可以确保构建时间是最优的，并保持这种状态。

#### 平行

我遇到过这样的团队，他们要么不完全了解他们技术堆栈的所有功能，要么没有充分利用这些功能。例如，我曾经和一些人交流过，他们在管道构建中使用了超过 45 分钟的综合测试套件来完成测试。他们确信这是执行测试的唯一方法。我能够帮助他们利用他们的技术堆栈中包含的一些[多线程处理](https://en.wikipedia.org/wiki/Multithreading_(computer_architecture))功能。

大多数技术堆栈都具有并行执行代码的能力，这意味着使用计算节点的可用未使用 CPU 内核同时执行多个元素和功能。并行性，也称为并发性，依赖于技术堆栈。它可以是本机提供的，也可以通过利用现有的多线程库或特性来实现。这些多线程功能大大加快了速度。它们可以在堆栈级别使用，而不是在 CI/CD 管道级别使用，在 CI/CD 管道级别，代码按照 CI/CD 配置语法中的定义执行。通过并发执行代码，从一开始就优化了执行时间，并且当应用于管道中的构建作业时，这些构建作业变得更快，而不必调整构建指令中的 CI/CD 配置参数。

在这种情况下，CI/CD 工程师可以帮助团队在核心技术堆栈中启用多线程，并在代码执行时利用通常未充分利用的 CPU 内核。这个角色可以识别效率不高的构建工作，并可以协作实现有效的执行策略。这些策略可以在技术堆栈级别利用多线程，产生利用所有可用 CPU 资源的并发流程实例。

这些优化也可以在 CI/CD 平台构建中实现和执行。CircleCI 还有一个[并行](https://circleci.com/docs/parallelism-faster-jobs/)的概念，这个概念和我之前讨论的多线程并发没有关系。CircleCI 版本的并行性支持在单个[执行器](https://circleci.com/docs/configuration-reference/#executors-requires-version-21)上同时执行多个构建任务。在任何情况下，让 CI/CD 工程师监督这些潜在的优化机会是 DevOps 团队中该角色的另一个理由。

### CI/CD 工程师的性能基准

CI/CD 工程师帮助维护和提高管道的一致性和速度，而不损害质量。CircleCI 拥有关于在平台上执行的 CI/CD 构建的大量数据，这些数据使 CircleCI 能够准确地识别、捕获和生成有价值的性能基准。这些性能基准是一些有趣的交付度量的核心，可以被团队用作目标。[2020 年软件交付状态 2020:工程团队的数据支持基准](https://circleci.com/resources/2020-state-of-software-delivery/)报告围绕软件开发团队如何基于以下数据点或基准来衡量他们的绩效:

*   **吞吐量:**大部分时间或所有时间，工作流运行的数量不如处于部署就绪状态重要
*   **持续时间:**团队希望工作流程的持续时间在五到十分钟之间
*   **恢复时间:**团队应该致力于在一个小时内修复或恢复任何失败的运行
*   **成功率:**90%以上的成功率应该是你对应用默认分支的标准

这四个基准应该被认为是需要监控、捕获和改进的基线度量。每个组织和团队都有不同的特定于业务的目标，这些目标会影响开发效率。控制这种影响取决于扩展和改进底层流程。

CI/CD 工程师的角色绝对可以帮助团队对当前交付状况和 CI/CD 绩效进行有价值的监控和分析。凭借对管道执行和技术专业知识的深刻理解，他们可以合作制定绩效目标和指标，帮助实现和保持追求的结果。

软件开发团队经常对提高开发速度感兴趣，但是与实际的构建活动脱节，而实际的构建活动是影响和控制这些结果的因素。CI/CD 工程师与交付流程密切相关，能够有效地监控和解决出现的缺陷，并在新的或现有基准的基础上进行扩展和改进。他们可以提供近乎实时的监控，使团队能够成功地按照他们期望的速度前进。

## 结论

我已经展示了 CI/CD 工程师角色的最新观点，并添加了一些新的观点。在这次更新中，我分享了一些新的想法和概念，我认为这些想法和概念可能对这个角色有价值。这些想法集中在安全/开发操作、管道优化和性能基准上，所有这些都是对关键软件交付实践非常有影响的概念。

我很想知道你对这个角色的想法和意见，所以请发推文给我 [@punkdata](https://twitter.com/punkdata) 加入讨论。希望我们能一起把这个想法变成现实。

感谢阅读！